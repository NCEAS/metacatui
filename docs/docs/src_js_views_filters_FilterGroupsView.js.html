<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>MetacatUI Dev Docs: Source: src/js/views/filters/FilterGroupsView.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="/metacatui/assets/css/styles.css">
    <link type="text/css" rel="stylesheet" href="styles/style.css">
</head>

<body>

<nav id="nav">
    <a href="/">
      <div class="logo">
<svg class="cat" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="cat" class="svg-inline--fa fa-cat fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M290.59 192c-20.18 0-106.82 1.98-162.59 85.95V192c0-52.94-43.06-96-96-96-17.67 0-32 14.33-32 32s14.33 32 32 32c17.64 0 32 14.36 32 32v256c0 35.3 28.7 64 64 64h176c8.84 0 16-7.16 16-16v-16c0-17.67-14.33-32-32-32h-32l128-96v144c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16V289.86c-10.29 2.67-20.89 4.54-32 4.54-61.81 0-113.52-44.05-125.41-102.4zM448 96h-64l-64-64v134.4c0 53.02 42.98 96 96 96s96-42.98 96-96V32l-64 64zm-72 80c-8.84 0-16-7.16-16-16s7.16-16 16-16 16 7.16 16 16-7.16 16-16 16zm80 0c-8.84 0-16-7.16-16-16s7.16-16 16-16 16 7.16 16 16-7.16 16-16 16z"></path></svg>

<svg width="459px" height="53px" viewBox="0 0 459 53" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g id="metacatui" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <path d="M16.492,52 C17.212,52 17.812,51.748 18.292,51.244 C18.772,50.74 19.012,50.128 19.012,49.408 L19.012,49.408 L18.94,22.912 L30.82,37.816 C31.204,38.344 31.72,38.764 32.368,39.076 C33.016,39.388 33.7,39.544 34.42,39.544 C35.908,39.544 37.132,38.896 38.092,37.6 L38.092,37.6 L49.684,22.912 L49.684,49.408 C49.684,50.128 49.96,50.74 50.512,51.244 C51.064,51.748 51.7,52 52.42,52 L52.42,52 L62.068,52 C62.788,52 63.388,51.748 63.868,51.244 C64.348,50.74 64.588,50.128 64.588,49.408 L64.588,49.408 L64.588,4.12 C64.588,3.448 64.336,2.86 63.832,2.356 C63.328,1.852 62.74,1.6 62.068,1.6 L62.068,1.6 L52.348,1.6 C51.388,1.6 50.56,1.648 49.864,1.744 C49.168,1.84 48.532,2.152 47.956,2.68 L47.956,2.68 L33.916,17.296 L20.524,2.608 C20.332,2.368 19.972,2.14 19.444,1.924 C18.916,1.708 18.412,1.6 17.932,1.6 L17.932,1.6 L6.772,1.6 C6.052,1.6 5.44,1.852 4.936,2.356 C4.432,2.86 4.18,3.448 4.18,4.12 L4.18,4.12 L4.18,49.408 C4.18,50.08 4.432,50.68 4.936,51.208 C5.44,51.736 6.052,52 6.772,52 L6.772,52 L16.492,52 Z M110.74,52 C111.556,52 112.264,51.676 112.864,51.028 C113.464,50.38 113.764,49.624 113.764,48.76 L113.764,48.76 L113.764,42.568 C113.764,41.608 113.464,40.828 112.864,40.228 C112.264,39.628 111.556,39.328 110.74,39.328 L110.74,39.328 L89.428,39.328 L89.428,32.92 L109.732,32.92 C110.5,32.92 111.184,32.596 111.784,31.948 C112.384,31.3 112.684,30.568 112.684,29.752 L112.684,29.752 L112.684,23.488 C112.684,22.576 112.384,21.82 111.784,21.22 C111.184,20.62 110.5,20.32 109.732,20.32 L109.732,20.32 L89.428,20.32 L89.428,14.488 L110.74,14.488 C111.508,14.488 112.204,14.164 112.828,13.516 C113.452,12.868 113.764,12.136 113.764,11.32 L113.764,11.32 L113.764,5.056 C113.764,4.144 113.464,3.388 112.864,2.788 C112.264,2.188 111.556,1.888 110.74,1.888 L110.74,1.888 L76.756,1.888 C75.94,1.888 75.232,2.188 74.632,2.788 C74.032,3.388 73.732,4.144 73.732,5.056 L73.732,5.056 L73.732,48.76 C73.732,49.624 74.032,50.38 74.632,51.028 C75.232,51.676 75.94,52 76.756,52 L76.756,52 L110.74,52 Z M147.604,52 C148.42,52 149.104,51.688 149.656,51.064 C150.208,50.44 150.484,49.672 150.484,48.76 L150.484,48.76 L150.484,16.216 L161.86,16.216 C162.676,16.216 163.396,15.904 164.02,15.28 C164.644,14.656 164.956,13.936 164.956,13.12 L164.956,13.12 L164.956,4.768 C164.956,4 164.644,3.316 164.02,2.716 C163.396,2.116 162.676,1.816 161.86,1.816 L161.86,1.816 L124.132,1.816 C123.22,1.816 122.464,2.104 121.864,2.68 C121.264,3.256 120.964,3.952 120.964,4.768 L120.964,4.768 L120.964,13.12 C120.964,13.936 121.264,14.656 121.864,15.28 C122.464,15.904 123.22,16.216 124.132,16.216 L124.132,16.216 L135.652,16.216 L135.148,48.832 C135.148,49.744 135.424,50.5 135.976,51.1 C136.528,51.7 137.212,52 138.028,52 L138.028,52 L147.604,52 Z M175.828,52 C176.836,52 177.676,51.82 178.348,51.46 C179.02,51.1 179.452,50.584 179.644,49.912 L179.644,49.912 L181.876,42.712 L197.932,42.712 L200.164,49.912 C200.356,50.584 200.8,51.1 201.496,51.46 C202.192,51.82 203.044,52 204.052,52 L204.052,52 L213.916,52 C215.836,51.712 216.796,50.704 216.796,48.976 C216.796,48.304 216.676,47.596 216.436,46.852 C216.196,46.108 216.052,45.616 216.004,45.376 L216.004,45.376 L199.876,4.84 C199.588,3.976 199.036,3.232 198.22,2.608 C197.404,1.984 196.372,1.648 195.124,1.6 L195.124,1.6 L184.756,1.6 C183.604,1.648 182.608,1.948 181.768,2.5 C180.928,3.052 180.292,3.832 179.86,4.84 L179.86,4.84 L163.876,45.376 C163.828,45.472 163.672,45.916 163.408,46.708 C163.144,47.5 163.012,48.304 163.012,49.12 C163.012,50.752 163.948,51.712 165.82,52 L165.82,52 L175.828,52 Z M195.34,30.544 L184.036,30.544 L189.652,13.624 L195.34,30.544 Z M245.38,53.08 C250.612,53.08 255.652,51.544 260.5,48.472 C261.22,47.944 261.58,47.296 261.58,46.528 C261.58,45.808 261.292,45.16 260.716,44.584 L260.716,44.584 L252.796,36.808 C252.364,36.376 251.836,36.16 251.212,36.16 C250.78,36.16 250.372,36.256 249.988,36.448 C248.356,37.12 246.796,37.456 245.308,37.456 C243.244,37.456 241.348,36.952 239.62,35.944 C237.892,34.936 236.512,33.58 235.48,31.876 C234.448,30.172 233.932,28.336 233.932,26.368 C233.932,24.352 234.436,22.504 235.444,20.824 C236.452,19.144 237.832,17.812 239.584,16.828 C241.336,15.844 243.244,15.352 245.308,15.352 C246.892,15.352 248.332,15.64 249.628,16.216 C250.012,16.408 250.444,16.504 250.924,16.504 C251.548,16.504 252.1,16.264 252.58,15.784 L252.58,15.784 L259.636,8.008 C260.164,7.384 260.428,6.76 260.428,6.136 C260.428,5.224 259.996,4.528 259.132,4.048 C254.86,1.552 250.276,0.304 245.38,0.304 C240.532,0.304 236.032,1.492 231.88,3.868 C227.728,6.244 224.44,9.448 222.016,13.48 C219.592,17.512 218.38,21.904 218.38,26.656 C218.38,31.408 219.592,35.812 222.016,39.868 C224.44,43.924 227.728,47.14 231.88,49.516 C236.032,51.892 240.532,53.08 245.38,53.08 Z M279.796,52 C280.804,52 281.644,51.82 282.316,51.46 C282.988,51.1 283.42,50.584 283.612,49.912 L283.612,49.912 L285.844,42.712 L301.9,42.712 L304.132,49.912 C304.324,50.584 304.768,51.1 305.464,51.46 C306.16,51.82 307.012,52 308.02,52 L308.02,52 L317.884,52 C319.804,51.712 320.764,50.704 320.764,48.976 C320.764,48.304 320.644,47.596 320.404,46.852 C320.164,46.108 320.02,45.616 319.972,45.376 L319.972,45.376 L303.844,4.84 C303.556,3.976 303.004,3.232 302.188,2.608 C301.372,1.984 300.34,1.648 299.092,1.6 L299.092,1.6 L288.724,1.6 C287.572,1.648 286.576,1.948 285.736,2.5 C284.896,3.052 284.26,3.832 283.828,4.84 L283.828,4.84 L267.844,45.376 C267.796,45.472 267.64,45.916 267.376,46.708 C267.112,47.5 266.98,48.304 266.98,49.12 C266.98,50.752 267.916,51.712 269.788,52 L269.788,52 L279.796,52 Z M299.308,30.544 L288.004,30.544 L293.62,13.624 L299.308,30.544 Z M352.588,52 C353.404,52 354.088,51.688 354.64,51.064 C355.192,50.44 355.468,49.672 355.468,48.76 L355.468,48.76 L355.468,16.216 L366.844,16.216 C367.66,16.216 368.38,15.904 369.004,15.28 C369.628,14.656 369.94,13.936 369.94,13.12 L369.94,13.12 L369.94,4.768 C369.94,4 369.628,3.316 369.004,2.716 C368.38,2.116 367.66,1.816 366.844,1.816 L366.844,1.816 L329.116,1.816 C328.204,1.816 327.448,2.104 326.848,2.68 C326.248,3.256 325.948,3.952 325.948,4.768 L325.948,4.768 L325.948,13.12 C325.948,13.936 326.248,14.656 326.848,15.28 C327.448,15.904 328.204,16.216 329.116,16.216 L329.116,16.216 L340.636,16.216 L340.132,48.832 C340.132,49.744 340.408,50.5 340.96,51.1 C341.512,51.7 342.196,52 343.012,52 L343.012,52 L352.588,52 Z M402.052,52.792 C408.1,52.792 412.912,51.628 416.488,49.3 C420.064,46.972 422.536,44.068 423.904,40.588 C425.272,37.108 425.932,33.424 425.884,29.536 C425.884,29.5309474 425.883967,29.5237673 425.8839,29.5144598 L425.883102,29.4330859 C425.879911,29.1480111 425.868211,28.3183158 425.848,26.944 C425.8294,25.6792 425.818008,22.91524 425.813823,18.65212 L425.813103,17.80828 C425.812997,17.66452 425.8129,17.5192 425.81281,17.37232 L425.812,3.904 C425.86,3.184 425.632,2.62 425.128,2.212 C424.624,1.804 423.916,1.6 423.004,1.6 L423.004,1.6 L413.428,1.6 C412.612,1.6 411.904,1.828 411.304,2.284 C410.704,2.74 410.404,3.28 410.404,3.904 L410.404,3.904 L410.26,27.808 C410.26,34.144 407.476,37.312 401.908,37.312 C399.076,37.312 396.832,36.412 395.176,34.612 C393.52,32.812 392.668,30.352 392.62,27.232 L392.62,27.232 L392.332,3.76 C392.332,3.088 392.068,2.56 391.54,2.176 C391.012,1.792 390.268,1.6 389.308,1.6 L389.308,1.6 L379.876,1.6 C378.244,1.6 377.428,2.32 377.428,3.76 L377.428,3.76 L377.5,28.816 C377.5,33.04 378.376,36.964 380.128,40.588 C381.88,44.212 384.592,47.152 388.264,49.408 C391.936,51.664 396.532,52.792 402.052,52.792 Z M449.284,52.144 C450.148,52.144 450.88,51.844 451.48,51.244 C452.08,50.644 452.38,49.84 452.38,48.832 L452.38,48.832 L452.38,4.912 C452.38,4 452.08,3.22 451.48,2.572 C450.88,1.924 450.148,1.6 449.284,1.6 L449.284,1.6 L439.42,1.6 C438.46,1.6 437.692,1.924 437.116,2.572 C436.54,3.22 436.252,4 436.252,4.912 L436.252,4.912 L436.252,48.832 C436.252,49.84 436.54,50.644 437.116,51.244 C437.692,51.844 438.46,52.144 439.42,52.144 L439.42,52.144 L449.284,52.144 Z" id="metacatui" fill="#FCBF49" fill-rule="nonzero"></path>
    </g>
</svg>
</logo>

    </a>
    <h3>Namespaces</h3><ul><li><a href="AppConfig.html">AppConfig</a></li><li><a href="IconUtilities.html">IconUtilities</a></li><li><a href="MapConfig.html">MapConfig</a></li><li><a href="MetacatUI.html">MetacatUI</a></li><li><a href="Utilities.html">Utilities</a></li></ul><h3>Classes</h3><ul><li class='category-heading' data-category='Collections'>Collections</li><li><a href="AccessPolicy.html">AccessPolicy</a></li><li><a href="Citations.html">Citations</a></li><li><a href="DataPackage.html">DataPackage</a></li><li><a href="Filters.html">Filters</a></li><li><a href="ObjectFormats.html">ObjectFormats</a></li><li><a href="ProjectList.html">ProjectList</a></li><li><a href="QualityReport.html">QualityReport</a></li><li><a href="SolrResults.html">SolrResults</a></li><li><a href="Units.html">Units</a></li><li><a href="UserGroup.html">UserGroup</a></li><li class='category-heading' data-category='Collections/Bookkeeper'>Collections/Bookkeeper</li><li><a href="Quotas.html">Quotas</a></li><li><a href="Usages.html">Usages</a></li><li class='category-heading' data-category='Collections/Geohashes'>Collections/Geohashes</li><li><a href="Geohashes.html">Geohashes</a></li><li class='category-heading' data-category='Collections/Maps'>Collections/Maps</li><li><a href="AssetCategories.html">AssetCategories</a></li><li><a href="AssetColors.html">AssetColors</a></li><li><a href="Features.html">Features</a></li><li><a href="GeoPoints.html">GeoPoints</a></li><li><a href="MapAssets.html">MapAssets</a></li><li><a href="VectorFilters.html">VectorFilters</a></li><li><a href="ZoomPresets.html">ZoomPresets</a></li><li class='category-heading' data-category='Collections/Metadata/EML'>Collections/Metadata/EML</li><li><a href="EMLAnnotations.html">EMLAnnotations</a></li><li><a href="EMLMissingValueCodes.html">EMLMissingValueCodes</a></li><li class='category-heading' data-category='Collections/QueryFields'>Collections/QueryFields</li><li><a href="QueryFields.html">QueryFields</a></li><li class='category-heading' data-category='Models'>Models</li><li><a href="AccessRule.html">AccessRule</a></li><li><a href="AppModel.html">AppModel</a></li><li><a href="CitationModel.html">CitationModel</a></li><li><a href="CollectionModel.html">CollectionModel</a></li><li><a href="DataONEObject.html">DataONEObject</a></li><li><a href="LookupModel.html">LookupModel</a></li><li><a href="Map.html">Map</a></li><li><a href="Metrics.html">Metrics</a></li><li><a href="QualityCheck.html">QualityCheck</a></li><li><a href="Search.html">Search</a></li><li><a href="SolrResult.html">SolrResult</a></li><li><a href="Stats.html">Stats</a></li><li class='category-heading' data-category='Models/Analytics'>Models/Analytics</li><li><a href="Analytics.html">Analytics</a></li><li><a href="GoogleAnalytics.html">GoogleAnalytics</a></li><li class='category-heading' data-category='Models/Bookkeeper'>Models/Bookkeeper</li><li><a href="Quota.html">Quota</a></li><li><a href="Subscription.html">Subscription</a></li><li><a href="Usage.html">Usage</a></li><li class='category-heading' data-category='Models/Connectors'>Models/Connectors</li><li><a href="FiltersMapConnector.html">FiltersMapConnector</a></li><li><a href="FiltersSearchConnector.html">FiltersSearchConnector</a></li><li><a href="GeoPointsCesiumConnector.html">GeoPointsCesiumConnector</a></li><li><a href="GeoPointsCesiumPointsConnector.html">GeoPointsCesiumPointsConnector</a></li><li><a href="GeoPointsCesiumPolygonConnector.html">GeoPointsCesiumPolygonConnector</a></li><li><a href="MapSearchConnector.html">MapSearchConnector</a></li><li><a href="MapSearchFiltersConnector.html">MapSearchFiltersConnector</a></li><li class='category-heading' data-category='Models/Filters'>Models/Filters</li><li><a href="BooleanFilter.html">BooleanFilter</a></li><li><a href="ChoiceFilter.html">ChoiceFilter</a></li><li><a href="DateFilter.html">DateFilter</a></li><li><a href="Filter.html">Filter</a></li><li><a href="FilterGroup.html">FilterGroup</a></li><li><a href="NumericFilter.html">NumericFilter</a></li><li><a href="SpatialFilter.html">SpatialFilter</a></li><li><a href="ToggleFilter.html">ToggleFilter</a></li><li class='category-heading' data-category='Models/Formats'>Models/Formats</li><li><a href="ObjectFormat.html">ObjectFormat</a></li><li class='category-heading' data-category='Models/Geocoder'>Models/Geocoder</li><li><a href="GeocodedLocation.html">GeocodedLocation</a></li><li><a href="GeocoderSearch.html">GeocoderSearch</a></li><li><a href="GoogleMapsAutocompleter.html">GoogleMapsAutocompleter</a></li><li><a href="GoogleMapsGeocoder.html">GoogleMapsGeocoder</a></li><li><a href="Prediction.html">Prediction</a></li><li class='category-heading' data-category='Models/Geohashes'>Models/Geohashes</li><li><a href="Geohash.html">Geohash</a></li><li class='category-heading' data-category='Models/Maps'>Models/Maps</li><li><a href="AssetCategory.html">AssetCategory</a></li><li><a href="AssetColor.html">AssetColor</a></li><li><a href="AssetColorPalette.html">AssetColorPalette</a></li><li><a href="ExpansionPanelsModel.html">ExpansionPanelsModel</a></li><li><a href="Feature.html">Feature</a></li><li><a href="GeoBoundingBox.html">GeoBoundingBox</a></li><li><a href="GeoPoint.html">GeoPoint</a></li><li><a href="GeoScale.html">GeoScale</a></li><li><a href="GeoUtilities.html">GeoUtilities</a></li><li><a href="MapInteraction.html">MapInteraction</a></li><li><a href="MapModel.html">MapModel</a></li><li><a href="VectorFilter.html">VectorFilter</a></li><li><a href="ViewfinderModel.html">ViewfinderModel</a></li><li><a href="ZoomPresetModel.html">ZoomPresetModel</a></li><li class='category-heading' data-category='Models/Maps/Assets'>Models/Maps/Assets</li><li><a href="Cesium3DTileset.html">Cesium3DTileset</a></li><li><a href="CesiumGeohash.html">CesiumGeohash</a></li><li><a href="CesiumImagery.html">CesiumImagery</a></li><li><a href="CesiumTerrain.html">CesiumTerrain</a></li><li><a href="CesiumVectorData.html">CesiumVectorData</a></li><li><a href="MapAsset.html">MapAsset</a></li><li class='category-heading' data-category='Models/Metadata'>Models/Metadata</li><li><a href="ScienceMetadata.html">ScienceMetadata</a></li><li class='category-heading' data-category='Models/Metadata/EML'>Models/Metadata/EML</li><li><a href="EMLMethodStep.html">EMLMethodStep</a></li><li><a href="EMLSpecializedText.html">EMLSpecializedText</a></li><li><a href="EMLTaxonCoverage.html">EMLTaxonCoverage</a></li><li class='category-heading' data-category='Models/Metadata/EML211'>Models/Metadata/EML211</li><li><a href="EML211.html">EML211</a></li><li><a href="EMLAnnotation.html">EMLAnnotation</a></li><li><a href="EMLAttribute.html">EMLAttribute</a></li><li><a href="EMLDataTable.html">EMLDataTable</a></li><li><a href="EMLDistribution.html">EMLDistribution</a></li><li><a href="EMLEntity.html">EMLEntity</a></li><li><a href="EMLGeoCoverage.html">EMLGeoCoverage</a></li><li><a href="EMLMeasurementScale.html">EMLMeasurementScale</a></li><li><a href="EMLMethods.html">EMLMethods</a></li><li><a href="EMLMissingValueCode.html">EMLMissingValueCode</a></li><li><a href="EMLNonNumericDomain.html">EMLNonNumericDomain</a></li><li><a href="EMLNumericDomain.html">EMLNumericDomain</a></li><li><a href="EMLOtherEntity.html">EMLOtherEntity</a></li><li><a href="EMLParty.html">EMLParty</a></li><li><a href="EMLTemporalCoverage.html">EMLTemporalCoverage</a></li><li><a href="EMLText211.html">EMLText211</a></li><li><a href="EMLUnit.html">EMLUnit</a></li><li class='category-heading' data-category='Models/Metadata/EML220'>Models/Metadata/EML220</li><li><a href="EMLText.html">EMLText</a></li><li class='category-heading' data-category='Models/Portals'>Models/Portals</li><li><a href="PortalImage.html">PortalImage</a></li><li><a href="PortalModel.html">PortalModel</a></li><li><a href="PortalSectionModel.html">PortalSectionModel</a></li><li class='category-heading' data-category='Models/Projects'>Models/Projects</li><li><a href="Project.html">Project</a></li><li class='category-heading' data-category='Models/QueryFields'>Models/QueryFields</li><li><a href="QueryField.html">QueryField</a></li><li class='category-heading' data-category='Router'>Router</li><li><a href="UIRouter.html">UIRouter</a></li><li class='category-heading' data-category='Views'>Views</li><li><a href="AccessPolicyView.html">AccessPolicyView</a></li><li><a href="AccessRuleView.html">AccessRuleView</a></li><li><a href="AnnotationView.html">AnnotationView</a></li><li><a href="AppView.html">AppView</a></li><li><a href="CatalogSearchView.html">CatalogSearchView</a></li><li><a href="CitationHeaderView.html">CitationHeaderView</a></li><li><a href="CitationListView.html">CitationListView</a></li><li><a href="CitationModalView.html">CitationModalView</a></li><li><a href="CitationView.html">CitationView</a></li><li><a href="ColorPaletteView.html">ColorPaletteView</a></li><li><a href="DataCatalogViewWithFilters.html">DataCatalogViewWithFilters</a></li><li><a href="DataItemView.html">DataItemView</a></li><li><a href="DataPackageView.html">DataPackageView</a></li><li><a href="DraftsView.html">DraftsView</a></li><li><a href="EditCollectionView.html">EditCollectionView</a></li><li><a href="EditorView.html">EditorView</a></li><li><a href="FooterView.html">FooterView</a></li><li><a href="GroupListView.html">GroupListView</a></li><li><a href="ImageUploaderView.html">ImageUploaderView</a></li><li><a href="MarkdownEditorView.html">MarkdownEditorView</a></li><li><a href="MarkdownView.html">MarkdownView</a></li><li><a href="MdqRunView.html">MdqRunView</a></li><li><a href="MetadataView.html">MetadataView</a></li><li><a href="MetricModalView.html">MetricModalView</a></li><li><a href="MetricView.html">MetricView</a></li><li><a href="MetricsChartView.html">MetricsChartView</a></li><li><a href="NavbarView.html">NavbarView</a></li><li><a href="RegisterCitationView.html">RegisterCitationView</a></li><li><a href="SearchResultView.html">SearchResultView</a></li><li><a href="SignInView.html">SignInView</a></li><li><a href="TOCView.html">TOCView</a></li><li><a href="TableEditorView.html">TableEditorView</a></li><li><a href="UserGroupView.html">UserGroupView</a></li><li><a href="UserView.html">UserView</a></li><li class='category-heading' data-category='Views/Filters'>Views/Filters</li><li><a href="BooleanFilterView.html">BooleanFilterView</a></li><li><a href="ChoiceFilterView.html">ChoiceFilterView</a></li><li><a href="DateFilterView.html">DateFilterView</a></li><li><a href="FilterEditorView.html">FilterEditorView</a></li><li><a href="FilterGroupView.html">FilterGroupView</a></li><li><a href="FilterGroupsView.html">FilterGroupsView</a></li><li><a href="FilterView.html">FilterView</a></li><li><a href="NumericFilterView.html">NumericFilterView</a></li><li><a href="SemanticFilterView.html">SemanticFilterView</a></li><li><a href="ToggleFilterView.html">ToggleFilterView</a></li><li class='category-heading' data-category='Views/Maps'>Views/Maps</li><li><a href="CesiumWidgetView.html">CesiumWidgetView</a></li><li><a href="DrawTool.html">DrawTool</a></li><li><a href="FeatureInfoView.html">FeatureInfoView</a></li><li><a href="LayerCategoryItemView.html">LayerCategoryItemView</a></li><li><a href="LayerCategoryListView.html">LayerCategoryListView</a></li><li><a href="LayerDetailView.html">LayerDetailView</a></li><li><a href="LayerDetailsView.html">LayerDetailsView</a></li><li><a href="LayerInfoView.html">LayerInfoView</a></li><li><a href="LayerItemView.html">LayerItemView</a></li><li><a href="LayerListView.html">LayerListView</a></li><li><a href="LayerNavigationView.html">LayerNavigationView</a></li><li><a href="LayerOpacityView.html">LayerOpacityView</a></li><li><a href="LayersPanelView.html">LayersPanelView</a></li><li><a href="LegendView.html">LegendView</a></li><li><a href="MapHelpPanel.html">MapHelpPanel</a></li><li><a href="MapView.html">MapView</a></li><li><a href="PredictionView.html">PredictionView</a></li><li><a href="PredictionsListView.html">PredictionsListView</a></li><li><a href="ScaleBarView.html">ScaleBarView</a></li><li><a href="SearchInputView.html">SearchInputView</a></li><li><a href="SearchView.html">SearchView</a></li><li><a href="ToolbarView.html">ToolbarView</a></li><li><a href="ViewfinderView.html">ViewfinderView</a></li><li class='category-heading' data-category='Views/Maps/Viewfinder'>Views/Maps/Viewfinder</li><li><a href="ExpansionPanelView.html">ExpansionPanelView</a></li><li><a href="ZoomPresetView.html">ZoomPresetView</a></li><li><a href="ZoomPresetsListView.html">ZoomPresetsListView</a></li><li class='category-heading' data-category='Views/Metadata'>Views/Metadata</li><li><a href="EML211EditorView.html">EML211EditorView</a></li><li><a href="EMLAttributeView.html">EMLAttributeView</a></li><li><a href="EMLEntityView.html">EMLEntityView</a></li><li><a href="EMLMeasurementScaleView.html">EMLMeasurementScaleView</a></li><li><a href="EMLMeasurementTypeView.html">EMLMeasurementTypeView</a></li><li><a href="EMLMethodsView.html">EMLMethodsView</a></li><li><a href="EMLMissingValueCodeView.html">EMLMissingValueCodeView</a></li><li><a href="EMLMissingValueCodesView.html">EMLMissingValueCodesView</a></li><li><a href="EMLOtherEntityView.html">EMLOtherEntityView</a></li><li><a href="EMLPartyView.html">EMLPartyView</a></li><li><a href="EMLTempCoverageView.html">EMLTempCoverageView</a></li><li><a href="EMLView.html">EMLView</a></li><li><a href="EMlGeoCoverageView_.html">EMlGeoCoverageView</a></li><li><a href="ScienceMetadataView.html">ScienceMetadataView</a></li><li class='category-heading' data-category='Views/Portals'>Views/Portals</li><li><a href="PortalDataView.html">PortalDataView</a></li><li><a href="PortalHeaderView.html">PortalHeaderView</a></li><li><a href="PortalListView.html">PortalListView</a></li><li><a href="PortalLogosView.html">PortalLogosView</a></li><li><a href="PortalMembersView.html">PortalMembersView</a></li><li><a href="PortalSectionView.html">PortalSectionView</a></li><li><a href="PortalUsagesView.html">PortalUsagesView</a></li><li><a href="PortalView.html">PortalView</a></li><li><a href="PortalVisualizationsView.html">PortalVisualizationsView</a></li><li><a href="PortalsSearchView.html">PortalsSearchView</a></li><li class='category-heading' data-category='Views/Portals/Editor'>Views/Portals/Editor</li><li><a href="PortEditorDataView.html">PortEditorDataView</a></li><li><a href="PortEditorImageView.html">PortEditorImageView</a></li><li><a href="PortEditorLogosView.html">PortEditorLogosView</a></li><li><a href="PortEditorMdSectionView.html">PortEditorMdSectionView</a></li><li><a href="PortEditorSectionView.html">PortEditorSectionView</a></li><li><a href="PortEditorSectionsView.html">PortEditorSectionsView</a></li><li><a href="PortEditorSettingsView.html">PortEditorSettingsView</a></li><li><a href="PortalEditorView.html">PortalEditorView</a></li><li class='category-heading' data-category='Views/Projects'>Views/Projects</li><li><a href="ProjectView.html">ProjectView</a></li><li class='category-heading' data-category='Views/QueryBuilder'>Views/QueryBuilder</li><li><a href="QueryBuilderView.html">QueryBuilderView</a></li><li><a href="QueryRuleView.html">QueryRuleView</a></li><li class='category-heading' data-category='Views/Search'>Views/Search</li><li><a href="SearchResultsPagerView.html">SearchResultsPagerView</a></li><li><a href="SearchResultsView.html">SearchResultsView</a></li><li><a href="SorterView.html">SorterView</a></li><li class='category-heading' data-category='Views/SearchSelect'>Views/SearchSelect</li><li><a href="AccountSelectView.html">AccountSelectView</a></li><li><a href="AnnotationFilter.html">AnnotationFilter</a></li><li><a href="NodeSelect.html">NodeSelect</a></li><li><a href="ObjectFormatSelect.html">ObjectFormatSelect</a></li><li><a href="QueryFieldSelectView.html">QueryFieldSelectView</a></li><li><a href="SearchableSelectView.html">SearchableSelectView</a></li><li class='category-heading' data-category='Deprecated'>Deprecated</li><li><a href="AnnotatorView.html">AnnotatorView</a></li><li><a href="ExternalView.html">ExternalView</a></li><li><a href="LogsSearch.html">LogsSearch</a></li></ul><h3>Global</h3><ul><li><a href="global.html#appConfigPath">appConfigPath</a></li><li><a href="global.html#couldBeLatLong">couldBeLatLong</a></li><li><a href="global.html#taxonomicClassification">taxonomicClassification</a></li></ul>
</nav>

<div id="main">

    <h1 class="page-title">Source: src/js/views/filters/FilterGroupsView.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>define([
  "jquery",
  "underscore",
  "backbone",
  "collections/Filters",
  "models/filters/Filter",
  "models/filters/FilterGroup",
  "views/filters/FilterGroupView",
  "views/filters/FilterView",
  "text!templates/filters/filterGroups.html",
], function (
  $,
  _,
  Backbone,
  Filters,
  Filter,
  FilterGroup,
  FilterGroupView,
  FilterView,
  Template,
) {
  "use strict";

  /**
   * @class FilterGroupsView
   * @classdesc Creates a view of one or more FilterGroupViews
   * @classcategory Views/Filters
   * @name FilterGroupsView
   * @extends Backbone.View
   * @constructor
   */
  var FilterGroupsView = Backbone.View.extend(
    /** @lends FilterGroupsView.prototype */ {
      /**
       * The FilterGroup models to display in this view
       * @type {FilterGroup[]}
       */
      filterGroups: [],

      /**
       * The Filters Collection that contains the same Filter
       * models from each FilterGroup and any additional Filter Models that may not be in
       * FilterGroups because they're not displayed or applied behind the scenes.
       * @type {Filters}
       */
      filters: null,

      /**
       * A reference to the PortalEditorView
       * @type {PortalEditorView}
       */
      editorView: undefined,

      /**
       * @inheritdoc
       */
      tagName: "div",

      /**
       * @inheritdoc
       */
      className: "filter-groups tabbable",

      /**
       * The template for this view. An HTML file is converted to an Underscore.js template
       * @since 2.17.0
       */
      template: _.template(Template),

      /**
       * If true, displays the FilterGroups in a vertical list
       * @type {Boolean}
       */
      vertical: false,

      /**
       * Set to true to render this view as a FilterGroups editor; allow the user add, edit,
       * and remove FilterGroups (TODO), and to add, delete, and edit filters within groups.
       * @type {boolean}
       * @since 2.17.0
       */
      edit: false,

      /**
       * If set to true, then all filters within this group will be collapsible.
       * See {@link FilterView#collapsible}
       * @type {boolean}
       * @since 2.25.0
       * @default false
       */
      collapsible: false,

      /**
       * The initial query to use when the view is first rendered. This is a text value
       * that will be set on the general `text` Solr field.
       * @type {string}
       * @since 2.25.0
       */
      initialQuery: undefined,

      /**
       * @inheritdoc
       */
      events: {
        "click .remove-filter": "handleRemove",
        "click .clear-all": "removeAllFilters",
      },

      /**
       * @inheritdoc
       */
      initialize: function (options) {
        if (!options || typeof options != "object") {
          var options = {};
        }

        this.filterGroups = options.filterGroups || new Array();
        this.filters = options.filters || new Filters();

        // For portal search filters, ID filters should be added to the query with an AND
        // operator, so that ID searches search *within* the definition collection.
        if (this.filters) {
          this.filters.mustMatchIds = true;
        }

        if (options.vertical == true) {
          this.vertical = true;
        }

        this.parentView = options.parentView || null;
        this.editorView = options.editorView || null;

        if (options.edit === true) {
          this.edit = true;
        }

        if (options.initialQuery) {
          this.initialQuery = options.initialQuery;
        }

        if (options.collapsible &amp;&amp; typeof options.collapsible === "boolean") {
          this.collapsible = options.collapsible;
        }
      },

      /**
       * @inheritdoc
       */
      render: function () {
        //Since this view may be re-rendered at some point, empty the element and remove listeners
        this.$el.empty();
        this.stopListening();

        // Add information about editing the filter groups if this view is in edit mode
        if (this.edit) {
          var title =
            "Change how people can search for data within your collection";
          var isNew = this.filterGroups.length === 0;
          if (
            this.filterGroups.length === 1 &amp;&amp;
            this.filterGroups[0].isEmpty()
          ) {
            var isNew = true;
          }

          if (isNew) {
            title =
              "Add filters to help people find data within your collection";
          }

          var description =
              "Search filters allow people to filter your data by specific " +
              "metadata fields.",
            learnMoreUrl = MetacatUI.appModel.get("portalSearchFiltersInfoURL");

          if (learnMoreUrl) {
            description =
              description + ' &lt;a href="' + learnMoreUrl + '">Learn more&lt;/a>';
          }

          this.$el.html(
            this.template({
              title: title,
              description: description,
              helpText: "",
            }),
          );

          // Remove this when the custom search filter builder is no longer new:
          this.$el
            .find(".port-editor-subtitle")
            .append(
              $(
                '&lt;span class="new-icon" style="margin-left:10px; font-size:1rem; line-height: 25px;">&lt;i class="icon icon-star icon-on-right">&lt;/i> NEW &lt;/span>',
              ),
            );
        }

        //Create an unordered list for all the filter tabs
        var groupTabs = $(document.createElement("ul")).addClass(
          "nav nav-tabs filter-group-links",
        );

        // Until we allow adding/editing filter groups in the portal data page, hide the group tabs
        // element if the portal does not already have groups in the editor.
        if (
          this.filterGroups.length === 1 &amp;&amp;
          !this.filterGroups[0].get("label") &amp;&amp;
          !this.filterGroups[0].get("icon")
        ) {
          groupTabs.hide();
        }

        //Create a container div for the filter groups
        var filterGroupContainer = $(document.createElement("div")).addClass(
          "tab-content",
        );

        //Add the filter group elements to this view
        this.$el.append(groupTabs, filterGroupContainer);

        var divideIntoGroups = true;

        _.each(
          this.filterGroups,
          function (filterGroup) {
            //If there is only one filter group specified, and there is no label or icon,
            // then don't divide the filters into separate filter groups
            if (
              this.filterGroups.length == 1 &amp;&amp;
              !this.filterGroups[0].get("label") &amp;&amp;
              !this.filterGroups[0].get("icon")
            ) {
              divideIntoGroups = false;
            }

            if (divideIntoGroups) {
              //Create a link to the filter group
              var groupTab = $(document.createElement("li")).addClass(
                "filter-group-link",
              );
              var groupLink = $(document.createElement("a"))
                .attr(
                  "href",
                  "#" + filterGroup.get("label").replace(/([^a-zA-Z0-9])/g, ""),
                )
                .attr("data-toggle", "tab");

              //Add the FilterGroup icon
              if (filterGroup.get("icon")) {
                groupLink.append(
                  $(document.createElement("i")).addClass(
                    "icon icon-" + filterGroup.get("icon"),
                  ),
                );
              }

              //Add the FilterGroup label
              if (filterGroup.get("label")) {
                groupLink.append(filterGroup.get("label"));
              }

              //Insert the link into the tab and add the tab to the tab list
              groupTab.append(groupLink);
              groupTabs.append(groupTab);

              //Create a tooltip for the link
              groupTab.tooltip({
                placement: "top",
                title: filterGroup.get("description"),
                trigger: "hover",
                delay: {
                  show: 800,
                },
              });

              //Make all the tab widths equal
              groupTab.css("width", 100 / this.filterGroups.length + "%");
            }

            // Create a FilterGroupView. Ensure the FilterGroup is in edit mode if the parent
            // FilterGroups is.
            var filterGroupView = new FilterGroupView({
              model: filterGroup,
              edit: this.edit,
              editorView: this.editorView,
              collapsible: this.collapsible,
            });

            //Render the FilterGroupView
            filterGroupView.render();

            //Add the FilterGroupView element to this view
            filterGroupContainer.append(filterGroupView.el);

            //Store a reference to the FilterGroupView in the tab link
            if (divideIntoGroups) {
              groupLink.data("view", filterGroupView);
            }

            //If a new filter is ever added to this filter group, re-render this view
            this.listenTo(
              filterGroup.get("filters"),
              "add remove",
              this.render,
            );
          },
          this,
        );

        if (divideIntoGroups) {
          //Mark the first filter group as active
          groupTabs.children("li").first().addClass("active");

          //When each filter group tab is shown, perform any post render function, if needed.
          this.$('a[data-toggle="tab"]').on("shown", function (e) {
            //Get the filter group view
            var filterGroupView = $(e.target).data("view");

            //If there is a post render function, call it
            if (filterGroupView &amp;&amp; filterGroupView.postRender) {
              filterGroupView.postRender();
            }
          });
        }

        //Mark the first filter group as active
        var firstFilterGroupEl = filterGroupContainer
          .find(".filter-group")
          .first();
        firstFilterGroupEl.addClass("active");
        var activeFilterGroup = firstFilterGroupEl.data("view");

        //Call postRender() now for the active FilterGroup, since the `shown` event
        // won't trigger until/unless it's hidden then shown again.
        if (activeFilterGroup) {
          activeFilterGroup.postRender();
        }

        // Applied filters and the general search input are not needed when this view is
        // in editing mode
        if (!this.edit) {
          //Add a header element above the filter groups
          this.$el.prepend(
            $(document.createElement("div")).addClass("filters-header"),
          );

          //Render the applied filters
          this.renderAppliedFiltersSection();

          // Render an "All" filter. If the view was initialized with an initial
          // query, set it on this filter.
          this.renderAllFilter(this.initialQuery);
        }

        if (this.edit) {
          this.$el.addClass("edit-mode");
        }

        if (this.vertical) {
          this.$el.addClass("vertical");
        }
      },

      /**
       * Renders the section of the view that will display the currently-applied filters
       */
      renderAppliedFiltersSection: function () {
        //Add a title to the header
        var appliedFiltersContainer = $(document.createElement("div")).addClass(
            "applied-filters-container",
          ),
          headerText = $(document.createElement("h5"))
            .addClass("filters-title")
            .text("Current search")
            .append(
              $(document.createElement("a"))
                .text("Clear all")
                .addClass("clear-all")
                .prepend(
                  $(document.createElement("i")).addClass(
                    "icon icon-remove icon-on-left",
                  ),
                ),
            );

        //Make the applied filters list
        var appliedFiltersEl = $(document.createElement("ul")).addClass(
          "applied-filters",
        );

        //Add the applied filters element to the filters header
        appliedFiltersContainer.append(headerText, appliedFiltersEl);
        this.$(".filters-header").append(appliedFiltersContainer);

        //Get all the nonNumeric filter models. Reject nested filterGroups.
        var nonNumericFilters = this.filters.reject(function (filterModel) {
          return ["FilterGroup", "NumericFilter", "DateFilter"].includes(
            filterModel.type,
          );
        });
        //Listen to changes on the "values" attribute for nonNumeric filters
        _.each(
          nonNumericFilters,
          function (nonNumericFilter) {
            this.listenTo(
              nonNumericFilter,
              "change:values",
              this.updateAppliedFilters,
            );

            if (nonNumericFilter.get("values").length) {
              this.updateAppliedFilters(nonNumericFilter, {
                displayWithoutChanges: true,
              });
            }
          },
          this,
        );

        //Get the numeric filters and listen to the min and max values
        var numericFilters = _.where(this.filters.models, {
          type: "NumericFilter",
        });
        _.each(
          numericFilters,
          function (numericFilter) {
            if (numericFilter.get("range") == true) {
              this.listenTo(
                numericFilter,
                "change:min change:max",
                this.updateAppliedRangeFilters,
              );

              var filterDefaults = numericFilter.defaults();

              if (
                numericFilter.get("min") != filterDefaults.min ||
                numericFilter.get("max") != filterDefaults.max ||
                numericFilter.get("values").length
              ) {
                this.updateAppliedRangeFilters(numericFilter, {
                  displayWithoutChanges: true,
                });
              }
            } else {
              this.listenTo(
                numericFilter,
                "change:values",
                this.updateAppliedRangeFilters,
              );

              if (
                numericFilter.get("values")[0] !=
                numericFilter.defaults().values[0]
              ) {
                this.updateAppliedRangeFilters(numericFilter, {
                  displayWithoutChanges: true,
                });
              }
            }
          },
          this,
        );

        //Get the date filters and listen to the min and max values
        var dateFilters = _.where(this.filters.models, { type: "DateFilter" });
        _.each(
          dateFilters,
          function (dateFilter) {
            this.listenTo(
              dateFilter,
              "change:min change:max",
              this.updateAppliedRangeFilters,
            );

            if (
              dateFilter.get("min") != dateFilter.defaults().min ||
              dateFilter.get("max") != dateFilter.defaults().max
            ) {
              this.updateAppliedRangeFilters(dateFilter, {
                displayWithoutChanges: true,
              });
            }
          },
          this,
        );

        //When a Filter has been removed from the Filters collection, remove it's DOM element from the page
        this.listenTo(this.filters, "remove", function (removedFilter) {
          this.removeAppliedFilterElByModel(removedFilter);
        });
      },

      /**
       * Renders an "All" filter that will search the general `text` Solr field
       * @param {string} searchFor - The initial value of the "All" filter. This
       * will get set on the filter model and trigger a change event. Optional.
       */
      renderAllFilter: function (searchFor = "") {
        //Create an "All" filter that will search the general `text` Solr field
        var filter = new Filter({
          fields: ["text"],
          label: "Search",
          description:
            "Search the datasets by typing in any keyword, topic, creator, etc.",
          placeholder: "Search these datasets",
        });
        this.filters.add(filter);

        //Create a FilterView for the All filter
        var filterView = new FilterView({
          model: filter,
        });
        this.listenTo(filter, "change:values", this.updateAppliedFilters);

        //Render the view and add the element to the filters header
        filterView.render();
        this.$(".filters-header").prepend(filterView.el);

        if (searchFor &amp;&amp; searchFor.length) {
          filter.set("values", [searchFor]);
        }
      },

      postRender: function () {
        var groupTabs = this.$(".filter-group-links");

        //Check if there is a difference in heights
        var maxHeight = 0;

        _.each(groupTabs.find("a"), function (link) {
          if ($(link).height() > maxHeight) {
            maxHeight = $(link).height();
          }
        });

        //Set the height of each filter group link so they are all equal
        _.each(groupTabs.find("a"), function (link) {
          if ($(link).height() &lt; maxHeight) {
            $(link).height(maxHeight + "px");
          }
        });
      },

      /**
       * Renders the values of the given Filter Model in the current filter model
       *
       * @param {Filter} filterModel - The FilterModel to display
       * @param {object} options - Additional options for this function
       * @property {boolean} options.displayWithoutChanges - If true, this filter will
       * display even if the value hasn't been changed
       */
      updateAppliedFilters: function (filterModel, options) {
        //Create an options object if one wasn't sent
        if (typeof options != "object") {
          var options = {};
        }
        this.options = options;
        var view = this;

        //If the value of this filter has changed, or if the displayWithoutChanges option
        // was passed, and if the filter is not invisible, then display it
        if (
          !filterModel.get("isInvisible") &amp;&amp;
          ((filterModel.changed &amp;&amp; filterModel.changed.values) ||
            options.displayWithoutChanges)
        ) {
          //Get the new values and the previous values
          var newValues = options.displayWithoutChanges
              ? filterModel.get("values")
              : filterModel.changed.values,
            previousValues = options.displayWithoutChanges
              ? []
              : filterModel.previousAttributes().values,
            //Find the values that were removed
            removedValues = _.difference(previousValues, newValues),
            //Find the values that were added
            addedValues = _.difference(newValues, previousValues);

          //If a filter has been added, display it
          _.each(
            addedValues,
            function (value) {
              //Add the applied filter to the view
              this.$(".applied-filters").append(
                this.createAppliedFilter(filterModel, value),
              );
            },
            this,
          );

          //Iterate over each removed filter value and remove them
          _.each(
            removedValues,
            function (value) {
              //Find all applied filter elements with a matching value
              var matchingFilters = this.$(
                ".applied-filter[data-value='" + value + "']",
              );

              //Iterate over each filter element with a matching value
              _.each(matchingFilters, function (matchingFilter) {
                //If this is the filter element associated with this filter model, then remove it
                if ($(matchingFilter).data("model") == filterModel) {
                  $(matchingFilter).remove();
                }
              });
            },
            this,
          );
        }

        //Toggle the applied filters header
        this.toggleAppliedFiltersHeader();
      },

      /**
       * Hides or shows the applied filter list title/header, as well as the help
       * message that lets the user know they can add filters when there are none
       */
      toggleAppliedFiltersHeader: function () {
        //If there is an applied filter
        if (this.$(".applied-filter").length) {
          // hide the "add some filters" help text
          //$(this.parentView.helpTextContainer).css("display", "none");
          // show the Clear All button
          this.$(".filters-title").css("display", "block");
        }
        //If there are no applied filters
        else {
          // show the "add some filters" help text
          //  $(this.parentView.helpTextContainer).css("display", "block");
          // hide the Clear All button
          this.$(".filters-title").css("display", "none");
        }
      },

      /**
       * When a NumericFilter or DateFilter model is changed, update the applied filters in the UI
       * @param {DateFilter|NumericFilter} filterModel - The model whose values to display
       * @param {object} [options] - Additional options for this function
       * @property {boolean} [options.displayWithoutChanges] - If true, this filter will display even if the value hasn't been changed
       */
      updateAppliedRangeFilters: function (filterModel, options) {
        if (!filterModel) {
          return;
        }

        if (typeof options === "undefined" || !options) {
          var options = {};
        }

        //If the Filter is invisible, don't render it
        if (filterModel.get("isInvisible")) {
          return;
        }

        //If the minimum and maximum values are set to the default, remove the filter element
        if (
          filterModel.get("min") == filterModel.get("rangeMin") &amp;&amp;
          filterModel.get("max") == filterModel.get("rangeMax")
        ) {
          //Find the applied filter element for this filter model
          _.each(
            this.$(".applied-filter"),
            function (filterEl) {
              if ($(filterEl).data("model") == filterModel) {
                //Remove the applied filter element
                $(filterEl).remove();
              }
            },
            this,
          );
        }
        //If the values attribue has changed, or if the displayWithoutChanges attribute was passed
        else if (
          (filterModel.changed &amp;&amp;
            (filterModel.changed.min || filterModel.changed.max)) ||
          options.displayWithoutChanges
        ) {
          //Create the filter label for ranges of numbers
          var filterValue = filterModel.getReadableValue();

          //Create the applied filter
          var appliedFilter = this.createAppliedFilter(
            filterModel,
            filterValue,
          );

          //Keep track if this filter is already displayed and needs to be replaced
          var replaced = false;

          //Check if this filter model already has an applied filter in the UI
          _.each(
            this.$(".applied-filter"),
            function (appliedFilterEl) {
              //If this applied filter already is displayed, replace it
              if ($(appliedFilterEl).data("model") == filterModel) {
                //Replace the applied filter element with the new one
                $(appliedFilterEl).replaceWith(appliedFilter);
                replaced = true;
              }
            },
            this,
          );

          if (!replaced) {
            //Add the applied filter to the view
            this.$(".applied-filters").append(appliedFilter);
          }
        }

        this.toggleAppliedFiltersHeader();
      },

      /**
       * Creates a single applied filter element and returns it. Filters can
       *  have multiple values, so one value is passed to this function at a time.
       * @param {Filter} filterModel - The Filter model that is being added to the display
       * @param {string|number|Boolean} value - The new value set on the Filter model that is displayed in this applied filter
       * @returns {jQuery} - The complete applied filter element
       */
      createAppliedFilter: function (filterModel, value) {
        //Create the filter label
        var filterLabel = filterModel.get("label"),
          filterValue = value;

        //If the filter type is Choice, get the choice label which can be different from the value
        if (filterModel.type == "ChoiceFilter") {
          //Find the choice object with the given value
          var matchingChoice = _.findWhere(filterModel.get("choices"), {
            value: value,
          });

          //Get the label for that choice
          if (matchingChoice) {
            filterValue = matchingChoice.label;
          }
        }
        //Create the filter label for boolean filters
        else if (filterModel.type == "BooleanFilter") {
          //If the filter is set to false, remove the applied filter element
          if (filterModel.get("values")[0] === false) {
            //Iterate over the applied filters
            _.each(
              this.$(".applied-filter"),
              function (appliedFilterEl) {
                //If this is the applied filter element for this model,
                if ($(appliedFilterEl).data("model") == filterModel) {
                  //Remove the applied filter element from the page
                  $(appliedFilterEl).remove();
                }
              },
              this,
            );

            //Exit the function at this point since there is nothing else to
            // do for false BooleanFilters
            return;
          } else if (filterModel.get("values")[0] === true) {
            if (!filterLabel) {
              filterLabel = filterModel.get("fields")[0];
              filterValue = "";
            }
          }
        } else if (filterModel.type == "ToggleFilter") {
          if (filterModel.get("values")[0] == filterModel.get("trueValue")) {
            if (filterModel.get("label") &amp;&amp; filterModel.get("trueLabel")) {
              filterValue = filterModel.get("trueLabel");
            } else if (
              !filterModel.get("label") &amp;&amp;
              filterModel.get("trueLabel")
            ) {
              filterLabel = "";
              filterValue = filterModel.get("trueLabel");
            } else if (filterModel.get("label")) {
              filterLabel = "";
              filterValue = filterModel.get("label");
            }
          } else {
            if (filterModel.get("label") &amp;&amp; filterModel.get("falseLabel")) {
              filterValue = filterModel.get("falseLabel");
            } else if (
              !filterModel.get("label") &amp;&amp;
              filterModel.get("falseLabel")
            ) {
              filterLabel = "";
              filterValue = filterModel.get("falseLabel");
            } else if (filterModel.get("label")) {
              filterLabel = "";
              filterValue = filterModel.get("label");
            }
          }
        }
        //If this Filter model is a full-text search, don't display a label
        else if (
          filterModel.get("fields").length == 1 &amp;&amp;
          filterModel.get("fields")[0] == "text"
        ) {
          filterLabel = "";
        }
        //isPartOf filters should just display the label, not the value
        else if (
          filterModel.get("fields").length == 1 &amp;&amp;
          filterModel.get("fields")[0] == "isPartOf"
        ) {
          filterValue = "";
        }
        //If the filter value is just an asterisk (i.e. `match anything`), just display the label
        else if (
          filterModel.get("values").length == 1 &amp;&amp;
          filterModel.get("values")[0] == "*"
        ) {
          filterValue = "";
        }
        //Filters with the valueLabels attribute want to display an alternate value from the raw value here
        else if (filterModel.get("valueLabels")) {
          filterValue = filterModel.get("valueLabels")[value] || value;
        } else if (!filterLabel) {
          filterLabel = filterModel.get("fields")[0];
        }

        //Create the applied filter element
        var removeIcon = $(document.createElement("a"))
            .addClass("icon icon-remove remove-filter icon-on-right")
            .attr("title", "Remove this filter"),
          appliedFilter = $(document.createElement("li"))
            .addClass("applied-filter label")
            .append(removeIcon)
            .data("model", filterModel)
            .attr("data-value", value);

        //Create an element to contain both the label and value
        var filterLabelEl = $(document.createElement("span")).addClass("label");
        var filterValueEl = $(document.createElement("span"))
          .addClass("value")
          .text(filterValue);

        var filterTextContainer = $(document.createElement("span")).append(
          filterLabelEl,
          filterValueEl,
        );

        //If there is both a label and value, separated them with a colon
        if (filterLabel &amp;&amp; filterValue) {
          filterLabelEl.text(filterLabel + ": ");
        }
        //Otherwise just use the label text only
        else if (filterLabel) {
          filterLabelEl.text(filterLabel);
        }

        //Add the filter text to the filter element
        appliedFilter.prepend(filterTextContainer);

        // Add a tooltip to the filter
        if (filterModel.get("description")) {
          appliedFilter.tooltip({
            placement: "right",
            title: filterModel.get("description"),
            trigger: "hover",
            delay: {
              show: 700,
            },
          });
        }

        return appliedFilter;
      },

      /**
       * Adds a custom filter that likely exists outside of the FilterGroups but needs
       * to be displayed with these other applied fitlers.
       *
       * @param {Filter} filterModel - The Filter Model to display
       */
      addCustomAppliedFilter: function (filterModel) {
        //If the Filter is invisible, don't render it
        if (filterModel.get("isInvisible")) {
          return;
        }

        //If this filter already exists in the applied filter list, exit this function
        var alreadyExists = _.find(
          this.$(".applied-filter.custom"),
          function (appliedFilterEl) {
            return $(appliedFilterEl).data("model") == filterModel;
          },
        );

        if (alreadyExists) {
          return;
        }

        //Create the applied filter element
        var removeIcon = $(document.createElement("a"))
            .addClass("icon icon-remove remove-filter icon-on-right")
            .attr("title", "Remove this filter"),
          filterText = $(document.createElement("span")).text(
            filterModel.get("label"),
          ),
          appliedFilter = $(document.createElement("li"))
            .addClass("applied-filter label custom")
            .append(filterText, removeIcon)
            .data("model", filterModel)
            .attr("data-value", filterModel.get("values"));

        if (filterModel.type == "SpatialFilter") {
          filterText.prepend(
            $(document.createElement("i")).addClass(
              "icon icon-on-left icon-" + filterModel.get("icon"),
            ),
          );
        }

        //Add the applied filter to the view
        this.$(".applied-filters").append(appliedFilter);

        //Display the filters title
        this.toggleAppliedFiltersHeader();
      },

      /**
       * Removes the custom applied filter from the UI.
       *
       * @param {Filter} filterModel - The Filter Model to display
       */
      removeCustomAppliedFilter: function (filterModel) {
        _.each(
          this.$(".custom.applied-filter"),
          function (appliedFilterEl) {
            if ($(appliedFilterEl).data("model") == filterModel) {
              $(appliedFilterEl).remove();
              this.trigger("customAppliedFilterRemoved", filterModel);
            }
          },
          this,
        );

        //Hide the filters title
        this.toggleAppliedFiltersHeader();
      },

      /**
    * When a remove button is clicked, get the filter model associated with it
    /* and remove the filter from the filter group
    *
    * @param {Event} - The DOM Event that occured on the filter remove icon
    */
      handleRemove: function (e) {
        // Ensure tooltips are removed
        try {
          if (e.delegateTarget) {
            $(e.delegateTarget).find(".tooltip").remove();
          }
        } catch (e) {
          console.log(
            "Could not remove tooltip from filter label, error message: " + e,
          );
        }

        //Get the applied filter element and the filter model associated with it
        var appliedFilterEl = $(e.target).parents(".applied-filter"),
          filterModel = appliedFilterEl.data("model");

        if (appliedFilterEl.is(".custom")) {
          this.removeCustomAppliedFilter(filterModel);
        } else {
          //Remove the filter from the filter group model
          this.removeFilter(filterModel, appliedFilterEl);
        }
      },

      /**
       * Remove the filter from the UI and the Search collection
       * @param {Filter} filterModel The Filter to remove from the Filters collection
       * @param {Element} appliedFilterEl The DOM Element for the applied filter on the page
       * @param {object} options Additional options for this function
       * @param {boolean} options.removeSilently If true, the Filter model will be removed siltently from the Filters collection.
       *  This is useful when removing multiple Filters at once, and triggering a remove/change/reset event after all have
       *  been removed.
       */
      removeFilter: function (filterModel, appliedFilterEl, options) {
        var removeSilently = false;

        //Create an options object if one wasn't sent
        if (typeof options != "object") {
          var options = {};
        }
        this.options = options;
        var view = this;

        //Parse all the additional options for this function
        if (typeof options == "object") {
          removeSilently =
            typeof options.removeSilently != "undefined"
              ? options.removeSilently
              : false;
        }

        if (filterModel) {
          //NumericFilters and DateFilters get the min and max values reset
          if (
            filterModel.type == "NumericFilter" ||
            filterModel.type == "DateFilter"
          ) {
            //Set the min and max values
            filterModel.set({
              min: filterModel.get("rangeMin"),
              max: filterModel.get("rangeMax"),
              values: filterModel.defaults().values,
            });

            if (!removeSilently) {
              //Trigger the reset event
              filterModel.trigger("rangeReset");
            }
          }
          //For all other filter types
          else {
            //Get the current value
            var modelValues = filterModel.get("values"),
              thisValue = $(appliedFilterEl).data("value");

            //Numbers that are set on the element `data` are stored as type `number`, but when `number`s are
            // set on Backbone models, they are converted to `string`s. So we need to check for this use case.
            if (typeof thisValue == "number") {
              //Convert the number to a string
              thisValue = thisValue.toString();
            }

            //Remove the value that was in this applied filter
            var newValues = _.without(modelValues, thisValue),
              setOptions = {};

            if (removeSilently) {
              setOptions.silent = true;
            }

            //Updates the values on the model
            filterModel.set("values", newValues, setOptions);
          }
        }
      },

      /**
       * Gets all the applied filters in this view and their associated filter models
       *   and removes them.
       */
      removeAllFilters: function () {
        let removedFilters = [];

        //Iterate over each applied filter in the view
        _.each(
          this.$(".applied-filter"),
          function (appliedFilterEl) {
            var $appliedFilterEl = $(appliedFilterEl);

            removedFilters.push($appliedFilterEl.data("model"));

            if ($appliedFilterEl.is(".custom")) {
              this.removeCustomAppliedFilter($appliedFilterEl.data("model"));
            } else {
              //Remove the filter from the fitler group. Do this silently since we will trigger a "reset" event later
              this.removeFilter(
                $appliedFilterEl.data("model"),
                appliedFilterEl,
                { removeSilently: true },
              );
            }

            //Remove the applied filter element from the page
            $appliedFilterEl.remove();
          },
          this,
        );

        //Trigger the reset event on the Filters collection
        this.filters.trigger("reset");

        //Trigger the remove event on all the models now that they are all removed
        _.invoke(removedFilters, "trigger", "remove");

        //Toggle the applied filters header
        this.toggleAppliedFiltersHeader();
      },

      /**
       * Remove the applied filter element for the given model
       * This only removed the element from the page, it doesn't update the model at all or
       * trigger any events.
       * @param {Filter} - The Filter model whose elements will be deleted
       */
      removeAppliedFilterElByModel: function (filterModel) {
        //Iterate over each applied filter element and find the matching filters
        this.$(".applied-filter").each(function (i, el) {
          if ($(el).data("model") == filterModel) {
            //Remove the element from the page
            $(el).remove();
          }
        });

        //Toggle the applied filters header
        this.toggleAppliedFiltersHeader();
      },
    },
  );
  return FilterGroupsView;
});
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
