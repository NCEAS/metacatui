<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>MetacatUI Dev Docs: Source: src/js/views/portals/PortalView.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="/metacatui/assets/css/styles.css">
    <link type="text/css" rel="stylesheet" href="styles/style.css">
</head>

<body>

<nav id="nav">
    <a href="/">
      <div class="logo">
<svg class="cat" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="cat" class="svg-inline--fa fa-cat fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M290.59 192c-20.18 0-106.82 1.98-162.59 85.95V192c0-52.94-43.06-96-96-96-17.67 0-32 14.33-32 32s14.33 32 32 32c17.64 0 32 14.36 32 32v256c0 35.3 28.7 64 64 64h176c8.84 0 16-7.16 16-16v-16c0-17.67-14.33-32-32-32h-32l128-96v144c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16V289.86c-10.29 2.67-20.89 4.54-32 4.54-61.81 0-113.52-44.05-125.41-102.4zM448 96h-64l-64-64v134.4c0 53.02 42.98 96 96 96s96-42.98 96-96V32l-64 64zm-72 80c-8.84 0-16-7.16-16-16s7.16-16 16-16 16 7.16 16 16-7.16 16-16 16zm80 0c-8.84 0-16-7.16-16-16s7.16-16 16-16 16 7.16 16 16-7.16 16-16 16z"></path></svg>

<svg width="459px" height="53px" viewBox="0 0 459 53" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g id="metacatui" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <path d="M16.492,52 C17.212,52 17.812,51.748 18.292,51.244 C18.772,50.74 19.012,50.128 19.012,49.408 L19.012,49.408 L18.94,22.912 L30.82,37.816 C31.204,38.344 31.72,38.764 32.368,39.076 C33.016,39.388 33.7,39.544 34.42,39.544 C35.908,39.544 37.132,38.896 38.092,37.6 L38.092,37.6 L49.684,22.912 L49.684,49.408 C49.684,50.128 49.96,50.74 50.512,51.244 C51.064,51.748 51.7,52 52.42,52 L52.42,52 L62.068,52 C62.788,52 63.388,51.748 63.868,51.244 C64.348,50.74 64.588,50.128 64.588,49.408 L64.588,49.408 L64.588,4.12 C64.588,3.448 64.336,2.86 63.832,2.356 C63.328,1.852 62.74,1.6 62.068,1.6 L62.068,1.6 L52.348,1.6 C51.388,1.6 50.56,1.648 49.864,1.744 C49.168,1.84 48.532,2.152 47.956,2.68 L47.956,2.68 L33.916,17.296 L20.524,2.608 C20.332,2.368 19.972,2.14 19.444,1.924 C18.916,1.708 18.412,1.6 17.932,1.6 L17.932,1.6 L6.772,1.6 C6.052,1.6 5.44,1.852 4.936,2.356 C4.432,2.86 4.18,3.448 4.18,4.12 L4.18,4.12 L4.18,49.408 C4.18,50.08 4.432,50.68 4.936,51.208 C5.44,51.736 6.052,52 6.772,52 L6.772,52 L16.492,52 Z M110.74,52 C111.556,52 112.264,51.676 112.864,51.028 C113.464,50.38 113.764,49.624 113.764,48.76 L113.764,48.76 L113.764,42.568 C113.764,41.608 113.464,40.828 112.864,40.228 C112.264,39.628 111.556,39.328 110.74,39.328 L110.74,39.328 L89.428,39.328 L89.428,32.92 L109.732,32.92 C110.5,32.92 111.184,32.596 111.784,31.948 C112.384,31.3 112.684,30.568 112.684,29.752 L112.684,29.752 L112.684,23.488 C112.684,22.576 112.384,21.82 111.784,21.22 C111.184,20.62 110.5,20.32 109.732,20.32 L109.732,20.32 L89.428,20.32 L89.428,14.488 L110.74,14.488 C111.508,14.488 112.204,14.164 112.828,13.516 C113.452,12.868 113.764,12.136 113.764,11.32 L113.764,11.32 L113.764,5.056 C113.764,4.144 113.464,3.388 112.864,2.788 C112.264,2.188 111.556,1.888 110.74,1.888 L110.74,1.888 L76.756,1.888 C75.94,1.888 75.232,2.188 74.632,2.788 C74.032,3.388 73.732,4.144 73.732,5.056 L73.732,5.056 L73.732,48.76 C73.732,49.624 74.032,50.38 74.632,51.028 C75.232,51.676 75.94,52 76.756,52 L76.756,52 L110.74,52 Z M147.604,52 C148.42,52 149.104,51.688 149.656,51.064 C150.208,50.44 150.484,49.672 150.484,48.76 L150.484,48.76 L150.484,16.216 L161.86,16.216 C162.676,16.216 163.396,15.904 164.02,15.28 C164.644,14.656 164.956,13.936 164.956,13.12 L164.956,13.12 L164.956,4.768 C164.956,4 164.644,3.316 164.02,2.716 C163.396,2.116 162.676,1.816 161.86,1.816 L161.86,1.816 L124.132,1.816 C123.22,1.816 122.464,2.104 121.864,2.68 C121.264,3.256 120.964,3.952 120.964,4.768 L120.964,4.768 L120.964,13.12 C120.964,13.936 121.264,14.656 121.864,15.28 C122.464,15.904 123.22,16.216 124.132,16.216 L124.132,16.216 L135.652,16.216 L135.148,48.832 C135.148,49.744 135.424,50.5 135.976,51.1 C136.528,51.7 137.212,52 138.028,52 L138.028,52 L147.604,52 Z M175.828,52 C176.836,52 177.676,51.82 178.348,51.46 C179.02,51.1 179.452,50.584 179.644,49.912 L179.644,49.912 L181.876,42.712 L197.932,42.712 L200.164,49.912 C200.356,50.584 200.8,51.1 201.496,51.46 C202.192,51.82 203.044,52 204.052,52 L204.052,52 L213.916,52 C215.836,51.712 216.796,50.704 216.796,48.976 C216.796,48.304 216.676,47.596 216.436,46.852 C216.196,46.108 216.052,45.616 216.004,45.376 L216.004,45.376 L199.876,4.84 C199.588,3.976 199.036,3.232 198.22,2.608 C197.404,1.984 196.372,1.648 195.124,1.6 L195.124,1.6 L184.756,1.6 C183.604,1.648 182.608,1.948 181.768,2.5 C180.928,3.052 180.292,3.832 179.86,4.84 L179.86,4.84 L163.876,45.376 C163.828,45.472 163.672,45.916 163.408,46.708 C163.144,47.5 163.012,48.304 163.012,49.12 C163.012,50.752 163.948,51.712 165.82,52 L165.82,52 L175.828,52 Z M195.34,30.544 L184.036,30.544 L189.652,13.624 L195.34,30.544 Z M245.38,53.08 C250.612,53.08 255.652,51.544 260.5,48.472 C261.22,47.944 261.58,47.296 261.58,46.528 C261.58,45.808 261.292,45.16 260.716,44.584 L260.716,44.584 L252.796,36.808 C252.364,36.376 251.836,36.16 251.212,36.16 C250.78,36.16 250.372,36.256 249.988,36.448 C248.356,37.12 246.796,37.456 245.308,37.456 C243.244,37.456 241.348,36.952 239.62,35.944 C237.892,34.936 236.512,33.58 235.48,31.876 C234.448,30.172 233.932,28.336 233.932,26.368 C233.932,24.352 234.436,22.504 235.444,20.824 C236.452,19.144 237.832,17.812 239.584,16.828 C241.336,15.844 243.244,15.352 245.308,15.352 C246.892,15.352 248.332,15.64 249.628,16.216 C250.012,16.408 250.444,16.504 250.924,16.504 C251.548,16.504 252.1,16.264 252.58,15.784 L252.58,15.784 L259.636,8.008 C260.164,7.384 260.428,6.76 260.428,6.136 C260.428,5.224 259.996,4.528 259.132,4.048 C254.86,1.552 250.276,0.304 245.38,0.304 C240.532,0.304 236.032,1.492 231.88,3.868 C227.728,6.244 224.44,9.448 222.016,13.48 C219.592,17.512 218.38,21.904 218.38,26.656 C218.38,31.408 219.592,35.812 222.016,39.868 C224.44,43.924 227.728,47.14 231.88,49.516 C236.032,51.892 240.532,53.08 245.38,53.08 Z M279.796,52 C280.804,52 281.644,51.82 282.316,51.46 C282.988,51.1 283.42,50.584 283.612,49.912 L283.612,49.912 L285.844,42.712 L301.9,42.712 L304.132,49.912 C304.324,50.584 304.768,51.1 305.464,51.46 C306.16,51.82 307.012,52 308.02,52 L308.02,52 L317.884,52 C319.804,51.712 320.764,50.704 320.764,48.976 C320.764,48.304 320.644,47.596 320.404,46.852 C320.164,46.108 320.02,45.616 319.972,45.376 L319.972,45.376 L303.844,4.84 C303.556,3.976 303.004,3.232 302.188,2.608 C301.372,1.984 300.34,1.648 299.092,1.6 L299.092,1.6 L288.724,1.6 C287.572,1.648 286.576,1.948 285.736,2.5 C284.896,3.052 284.26,3.832 283.828,4.84 L283.828,4.84 L267.844,45.376 C267.796,45.472 267.64,45.916 267.376,46.708 C267.112,47.5 266.98,48.304 266.98,49.12 C266.98,50.752 267.916,51.712 269.788,52 L269.788,52 L279.796,52 Z M299.308,30.544 L288.004,30.544 L293.62,13.624 L299.308,30.544 Z M352.588,52 C353.404,52 354.088,51.688 354.64,51.064 C355.192,50.44 355.468,49.672 355.468,48.76 L355.468,48.76 L355.468,16.216 L366.844,16.216 C367.66,16.216 368.38,15.904 369.004,15.28 C369.628,14.656 369.94,13.936 369.94,13.12 L369.94,13.12 L369.94,4.768 C369.94,4 369.628,3.316 369.004,2.716 C368.38,2.116 367.66,1.816 366.844,1.816 L366.844,1.816 L329.116,1.816 C328.204,1.816 327.448,2.104 326.848,2.68 C326.248,3.256 325.948,3.952 325.948,4.768 L325.948,4.768 L325.948,13.12 C325.948,13.936 326.248,14.656 326.848,15.28 C327.448,15.904 328.204,16.216 329.116,16.216 L329.116,16.216 L340.636,16.216 L340.132,48.832 C340.132,49.744 340.408,50.5 340.96,51.1 C341.512,51.7 342.196,52 343.012,52 L343.012,52 L352.588,52 Z M402.052,52.792 C408.1,52.792 412.912,51.628 416.488,49.3 C420.064,46.972 422.536,44.068 423.904,40.588 C425.272,37.108 425.932,33.424 425.884,29.536 C425.884,29.5309474 425.883967,29.5237673 425.8839,29.5144598 L425.883102,29.4330859 C425.879911,29.1480111 425.868211,28.3183158 425.848,26.944 C425.8294,25.6792 425.818008,22.91524 425.813823,18.65212 L425.813103,17.80828 C425.812997,17.66452 425.8129,17.5192 425.81281,17.37232 L425.812,3.904 C425.86,3.184 425.632,2.62 425.128,2.212 C424.624,1.804 423.916,1.6 423.004,1.6 L423.004,1.6 L413.428,1.6 C412.612,1.6 411.904,1.828 411.304,2.284 C410.704,2.74 410.404,3.28 410.404,3.904 L410.404,3.904 L410.26,27.808 C410.26,34.144 407.476,37.312 401.908,37.312 C399.076,37.312 396.832,36.412 395.176,34.612 C393.52,32.812 392.668,30.352 392.62,27.232 L392.62,27.232 L392.332,3.76 C392.332,3.088 392.068,2.56 391.54,2.176 C391.012,1.792 390.268,1.6 389.308,1.6 L389.308,1.6 L379.876,1.6 C378.244,1.6 377.428,2.32 377.428,3.76 L377.428,3.76 L377.5,28.816 C377.5,33.04 378.376,36.964 380.128,40.588 C381.88,44.212 384.592,47.152 388.264,49.408 C391.936,51.664 396.532,52.792 402.052,52.792 Z M449.284,52.144 C450.148,52.144 450.88,51.844 451.48,51.244 C452.08,50.644 452.38,49.84 452.38,48.832 L452.38,48.832 L452.38,4.912 C452.38,4 452.08,3.22 451.48,2.572 C450.88,1.924 450.148,1.6 449.284,1.6 L449.284,1.6 L439.42,1.6 C438.46,1.6 437.692,1.924 437.116,2.572 C436.54,3.22 436.252,4 436.252,4.912 L436.252,4.912 L436.252,48.832 C436.252,49.84 436.54,50.644 437.116,51.244 C437.692,51.844 438.46,52.144 439.42,52.144 L439.42,52.144 L449.284,52.144 Z" id="metacatui" fill="#FCBF49" fill-rule="nonzero"></path>
    </g>
</svg>
</logo>

    </a>
    <h3>Externals</h3><ul><li><a href="external-TaxonomicClassification.html">TaxonomicClassification</a></li></ul><h3>Namespaces</h3><ul><li><a href="AppConfig.html">AppConfig</a></li><li><a href="EMLUtilities.html">EMLUtilities</a></li><li><a href="IconUtilities.html">IconUtilities</a></li><li><a href="MapConfig.html">MapConfig</a></li><li><a href="MetacatUI.html">MetacatUI</a></li><li><a href="SearchParams.html">SearchParams</a></li><li><a href="Utilities.html">Utilities</a></li><li><a href="XMLUtilities.html">XMLUtilities</a></li></ul><h3>Classes</h3><ul><li class='category-heading' data-category='Collections'>Collections</li><li><a href="AccessPolicy.html">AccessPolicy</a></li><li><a href="Citations.html">Citations</a></li><li><a href="DataPackage.html">DataPackage</a></li><li><a href="Filters.html">Filters</a></li><li><a href="ObjectFormats.html">ObjectFormats</a></li><li><a href="ProjectList.html">ProjectList</a></li><li><a href="QualityReport.html">QualityReport</a></li><li><a href="SolrResults.html">SolrResults</a></li><li><a href="Units.html">Units</a></li><li><a href="UserGroup.html">UserGroup</a></li><li class='category-heading' data-category='Collections/Bookkeeper'>Collections/Bookkeeper</li><li><a href="Quotas.html">Quotas</a></li><li><a href="Usages.html">Usages</a></li><li class='category-heading' data-category='Collections/Geohashes'>Collections/Geohashes</li><li><a href="Geohashes.html">Geohashes</a></li><li class='category-heading' data-category='Collections/Maps'>Collections/Maps</li><li><a href="AssetCategories.html">AssetCategories</a></li><li><a href="AssetColors.html">AssetColors</a></li><li><a href="Features.html">Features</a></li><li><a href="GeoPoints.html">GeoPoints</a></li><li><a href="MapAssets.html">MapAssets</a></li><li><a href="VectorFilters.html">VectorFilters</a></li><li><a href="ZoomPresets.html">ZoomPresets</a></li><li class='category-heading' data-category='Collections/Metadata/EML'>Collections/Metadata/EML</li><li><a href="EMLAnnotations.html">EMLAnnotations</a></li><li><a href="EMLAttributes.html">EMLAttributes</a></li><li><a href="EMLEntities.html">EMLEntities</a></li><li><a href="EMLMissingValueCodes.html">EMLMissingValueCodes</a></li><li class='category-heading' data-category='Collections/Ontologies'>Collections/Ontologies</li><li><a href="BioontologyResults.html">BioontologyResults</a></li><li class='category-heading' data-category='Collections/QueryFields'>Collections/QueryFields</li><li><a href="QueryFields.html">QueryFields</a></li><li class='category-heading' data-category='Collections/SearchSelect'>Collections/SearchSelect</li><li><a href="SearchSelectOptions.html">SearchSelectOptions</a></li><li class='category-heading' data-category='Common'>Common</li><li><a href="ResourceMapResolver.html">ResourceMapResolver</a></li><li class='category-heading' data-category='Errors'>Errors</li><li><a href="EmptyAttributeListError.html">EmptyAttributeListError</a></li><li><a href="InvalidAttributeListError.html">InvalidAttributeListError</a></li><li class='category-heading' data-category='Models'>Models</li><li><a href="AccessRule.html">AccessRule</a></li><li><a href="Accordion.html">Accordion</a></li><li><a href="AppModel.html">AppModel</a></li><li><a href="CitationModel.html">CitationModel</a></li><li><a href="CollectionModel.html">CollectionModel</a></li><li><a href="CrossRef.html">CrossRef</a></li><li><a href="DataONEObject.html">DataONEObject</a></li><li><a href="LookupModel.html">LookupModel</a></li><li><a href="Map.html">Map</a></li><li><a href="Metrics.html">Metrics</a></li><li><a href="PackageModel.html">PackageModel</a></li><li><a href="QualityCheck.html">QualityCheck</a></li><li><a href="Search.html">Search</a></li><li><a href="SolrResult.html">SolrResult</a></li><li><a href="Stats.html">Stats</a></li><li><a href="UserModel.html">UserModel</a></li><li class='category-heading' data-category='Models/Accordion'>Models/Accordion</li><li><a href="AccordionItem.html">AccordionItem</a></li><li class='category-heading' data-category='Models/Analytics'>Models/Analytics</li><li><a href="Analytics.html">Analytics</a></li><li><a href="GoogleAnalytics.html">GoogleAnalytics</a></li><li class='category-heading' data-category='Models/Bookkeeper'>Models/Bookkeeper</li><li><a href="Quota.html">Quota</a></li><li><a href="Subscription.html">Subscription</a></li><li><a href="Usage.html">Usage</a></li><li class='category-heading' data-category='Models/Connectors'>Models/Connectors</li><li><a href="BioontologyAccordionSearchSelect.html">BioontologyAccordionSearchSelect</a></li><li><a href="FiltersMapConnector.html">FiltersMapConnector</a></li><li><a href="FiltersSearchConnector.html">FiltersSearchConnector</a></li><li><a href="GeoPointsCesiumConnector.html">GeoPointsCesiumConnector</a></li><li><a href="GeoPointsCesiumPointsConnector.html">GeoPointsCesiumPointsConnector</a></li><li><a href="GeoPointsCesiumPolygonConnector.html">GeoPointsCesiumPolygonConnector</a></li><li><a href="MapSearchConnector.html">MapSearchConnector</a></li><li><a href="MapSearchFiltersConnector.html">MapSearchFiltersConnector</a></li><li class='category-heading' data-category='Models/Filters'>Models/Filters</li><li><a href="BooleanFilter.html">BooleanFilter</a></li><li><a href="ChoiceFilter.html">ChoiceFilter</a></li><li><a href="DateFilter.html">DateFilter</a></li><li><a href="Filter.html">Filter</a></li><li><a href="FilterGroup.html">FilterGroup</a></li><li><a href="NumericFilter.html">NumericFilter</a></li><li><a href="SpatialFilter.html">SpatialFilter</a></li><li><a href="ToggleFilter.html">ToggleFilter</a></li><li class='category-heading' data-category='Models/Formats'>Models/Formats</li><li><a href="ObjectFormat.html">ObjectFormat</a></li><li class='category-heading' data-category='Models/Geocoder'>Models/Geocoder</li><li><a href="GeocodedLocation.html">GeocodedLocation</a></li><li><a href="GeocoderSearch.html">GeocoderSearch</a></li><li><a href="GoogleMapsAutocompleter.html">GoogleMapsAutocompleter</a></li><li><a href="GoogleMapsGeocoder.html">GoogleMapsGeocoder</a></li><li><a href="Prediction.html">Prediction</a></li><li class='category-heading' data-category='Models/Geohashes'>Models/Geohashes</li><li><a href="Geohash.html">Geohash</a></li><li class='category-heading' data-category='Models/Maps'>Models/Maps</li><li><a href="AssetCategory.html">AssetCategory</a></li><li><a href="AssetColor.html">AssetColor</a></li><li><a href="AssetColorPalette.html">AssetColorPalette</a></li><li><a href="ExpansionPanelsModel.html">ExpansionPanelsModel</a></li><li><a href="Feature.html">Feature</a></li><li><a href="GeoBoundingBox.html">GeoBoundingBox</a></li><li><a href="GeoPoint.html">GeoPoint</a></li><li><a href="GeoScale.html">GeoScale</a></li><li><a href="GeoUtilities.html">GeoUtilities</a></li><li><a href="MapInteraction.html">MapInteraction</a></li><li><a href="MapModel.html">MapModel</a></li><li><a href="VectorFilter.html">VectorFilter</a></li><li><a href="ViewfinderModel.html">ViewfinderModel</a></li><li><a href="ZoomPresetModel.html">ZoomPresetModel</a></li><li class='category-heading' data-category='Models/Maps/Assets'>Models/Maps/Assets</li><li><a href="Cesium3DTileset.html">Cesium3DTileset</a></li><li><a href="CesiumGeohash.html">CesiumGeohash</a></li><li><a href="CesiumImagery.html">CesiumImagery</a></li><li><a href="CesiumTerrain.html">CesiumTerrain</a></li><li><a href="CesiumVectorData.html">CesiumVectorData</a></li><li><a href="MapAsset.html">MapAsset</a></li><li class='category-heading' data-category='Models/Metadata'>Models/Metadata</li><li><a href="ScienceMetadata.html">ScienceMetadata</a></li><li class='category-heading' data-category='Models/Metadata/EML'>Models/Metadata/EML</li><li><a href="EMLMethodStep.html">EMLMethodStep</a></li><li><a href="EMLSpecializedText.html">EMLSpecializedText</a></li><li><a href="EMLTaxonCoverage.html">EMLTaxonCoverage</a></li><li class='category-heading' data-category='Models/Metadata/EML211'>Models/Metadata/EML211</li><li><a href="EML211.html">EML211</a></li><li><a href="EMLAnnotation.html">EMLAnnotation</a></li><li><a href="EMLAttribute.html">EMLAttribute</a></li><li><a href="EMLAttributeList.html">EMLAttributeList</a></li><li><a href="EMLDataTable.html">EMLDataTable</a></li><li><a href="EMLDistribution.html">EMLDistribution</a></li><li><a href="EMLEntity.html">EMLEntity</a></li><li><a href="EMLGeoCoverage.html">EMLGeoCoverage</a></li><li><a href="EMLMeasurementScale.html">EMLMeasurementScale</a></li><li><a href="EMLMethods.html">EMLMethods</a></li><li><a href="EMLMissingValueCode.html">EMLMissingValueCode</a></li><li><a href="EMLNonNumericDomain.html">EMLNonNumericDomain</a></li><li><a href="EMLNumericDomain.html">EMLNumericDomain</a></li><li><a href="EMLOtherEntity.html">EMLOtherEntity</a></li><li><a href="EMLParty.html">EMLParty</a></li><li><a href="EMLReferences.html">EMLReferences</a></li><li><a href="EMLTemporalCoverage.html">EMLTemporalCoverage</a></li><li><a href="EMLText211.html">EMLText211</a></li><li><a href="EMLUnit.html">EMLUnit</a></li><li class='category-heading' data-category='Models/Metadata/EML220'>Models/Metadata/EML220</li><li><a href="EMLText.html">EMLText</a></li><li class='category-heading' data-category='Models/Ontologies'>Models/Ontologies</li><li><a href="BioOntology.html">BioOntology</a></li><li><a href="Bioontology_.html">Bioontology</a></li><li><a href="BioontologyBatch.html">BioontologyBatch</a></li><li><a href="BioontologyClass.html">BioontologyClass</a></li><li class='category-heading' data-category='Models/Portals'>Models/Portals</li><li><a href="PortalImage.html">PortalImage</a></li><li><a href="PortalModel.html">PortalModel</a></li><li><a href="PortalSectionModel.html">PortalSectionModel</a></li><li class='category-heading' data-category='Models/Projects'>Models/Projects</li><li><a href="Project.html">Project</a></li><li class='category-heading' data-category='Models/QueryFields'>Models/QueryFields</li><li><a href="QueryField.html">QueryField</a></li><li class='category-heading' data-category='Models/SearchSelect'>Models/SearchSelect</li><li><a href="AccountSearchSelect.html">AccountSearchSelect</a></li><li><a href="QueryFieldSearchSelect.html">QueryFieldSearchSelect</a></li><li><a href="SearchSelect.html">SearchSelect</a></li><li><a href="SelectOptionModel.html">SelectOptionModel</a></li><li><a href="SolrAutocomplete.html">SolrAutocomplete</a></li><li class='category-heading' data-category='Models/SysMeta'>Models/SysMeta</li><li><a href="VersionTracker.html">VersionTracker</a></li><li class='category-heading' data-category='Models/schemaOrg'>Models/schemaOrg</li><li><a href="SchemaOrgModel.html">SchemaOrgModel</a></li><li class='category-heading' data-category='Router'>Router</li><li><a href="UIRouter.html">UIRouter</a></li><li class='category-heading' data-category='Views'>Views</li><li><a href="AccessPolicyView.html">AccessPolicyView</a></li><li><a href="AccessRuleView.html">AccessRuleView</a></li><li><a href="AnnotationView.html">AnnotationView</a></li><li><a href="AppView.html">AppView</a></li><li><a href="CanonicalDatasetHandlerView.html">CanonicalDatasetHandlerView</a></li><li><a href="CatalogSearchView.html">CatalogSearchView</a></li><li><a href="CitationHeaderView.html">CitationHeaderView</a></li><li><a href="CitationListView.html">CitationListView</a></li><li><a href="CitationModalView.html">CitationModalView</a></li><li><a href="CitationView.html">CitationView</a></li><li><a href="ColorPaletteView.html">ColorPaletteView</a></li><li><a href="DataCatalogView.html">DataCatalogView</a></li><li><a href="DataCatalogViewWithFilters.html">DataCatalogViewWithFilters</a></li><li><a href="DataItemView.html">DataItemView</a></li><li><a href="DataObjectView.html">DataObjectView</a></li><li><a href="DataPackageView.html">DataPackageView</a></li><li><a href="DownloadButtonView.html">DownloadButtonView</a></li><li><a href="DraftsView.html">DraftsView</a></li><li><a href="EditCollectionView.html">EditCollectionView</a></li><li><a href="EditorView.html">EditorView</a></li><li><a href="FooterView.html">FooterView</a></li><li><a href="GroupListView.html">GroupListView</a></li><li><a href="ImageUploaderView.html">ImageUploaderView</a></li><li><a href="MarkdownEditorView.html">MarkdownEditorView</a></li><li><a href="MarkdownView.html">MarkdownView</a></li><li><a href="MdqRunView.html">MdqRunView</a></li><li><a href="MetadataView.html">MetadataView</a></li><li><a href="MetricModalView.html">MetricModalView</a></li><li><a href="MetricView.html">MetricView</a></li><li><a href="MetricsChartView.html">MetricsChartView</a></li><li><a href="NavbarView.html">NavbarView</a></li><li><a href="RegisterCitationView.html">RegisterCitationView</a></li><li><a href="SearchResultView.html">SearchResultView</a></li><li><a href="SignInView.html">SignInView</a></li><li><a href="TOCView.html">TOCView</a></li><li><a href="TableEditorView.html">TableEditorView</a></li><li><a href="UserGroupView.html">UserGroupView</a></li><li><a href="UserView.html">UserView</a></li><li><a href="ViewDataButtonView.html">ViewDataButtonView</a></li><li class='category-heading' data-category='Views/Accordion'>Views/Accordion</li><li><a href="AccordionItemView.html">AccordionItemView</a></li><li><a href="AccordionView.html">AccordionView</a></li><li class='category-heading' data-category='Views/Filters'>Views/Filters</li><li><a href="BooleanFilterView.html">BooleanFilterView</a></li><li><a href="ChoiceFilterView.html">ChoiceFilterView</a></li><li><a href="DateFilterView.html">DateFilterView</a></li><li><a href="FilterEditorView.html">FilterEditorView</a></li><li><a href="FilterGroupView.html">FilterGroupView</a></li><li><a href="FilterGroupsView.html">FilterGroupsView</a></li><li><a href="FilterView.html">FilterView</a></li><li><a href="NumericFilterView.html">NumericFilterView</a></li><li><a href="SemanticFilterView.html">SemanticFilterView</a></li><li><a href="ToggleFilterView.html">ToggleFilterView</a></li><li class='category-heading' data-category='Views/Maps'>Views/Maps</li><li><a href="CesiumWidgetView.html">CesiumWidgetView</a></li><li><a href="DownloadPanelView.html">DownloadPanelView</a></li><li><a href="FeatureInfoView.html">FeatureInfoView</a></li><li><a href="LayerCategoryListView.html">LayerCategoryListView</a></li><li><a href="LayerDetailView.html">LayerDetailView</a></li><li><a href="LayerDetailsView.html">LayerDetailsView</a></li><li><a href="LayerInfoView.html">LayerInfoView</a></li><li><a href="LayerItemView.html">LayerItemView</a></li><li><a href="LayerListView.html">LayerListView</a></li><li><a href="LayerNavigationView.html">LayerNavigationView</a></li><li><a href="LayerOpacityView.html">LayerOpacityView</a></li><li><a href="LayersPanelView.html">LayersPanelView</a></li><li><a href="MapHelpPanel.html">MapHelpPanel</a></li><li><a href="MapView.html">MapView</a></li><li><a href="MapWidgetContainerView.html">MapWidgetContainerView</a></li><li><a href="PredictionView.html">PredictionView</a></li><li><a href="PredictionsListView.html">PredictionsListView</a></li><li><a href="ScaleBarView.html">ScaleBarView</a></li><li><a href="SchemaOrgView.html">SchemaOrgView</a></li><li><a href="SearchInputView.html">SearchInputView</a></li><li><a href="SearchView.html">SearchView</a></li><li><a href="ShareUrlView.html">ShareUrlView</a></li><li><a href="ToolbarView.html">ToolbarView</a></li><li><a href="VectorFilterView.html">VectorFilterView</a></li><li><a href="ViewfinderView.html">ViewfinderView</a></li><li class='category-heading' data-category='Views/Maps/Legend'>Views/Maps/Legend</li><li><a href="CategoricalSwatchView.html">CategoricalSwatchView</a></li><li><a href="ContinuousSwatchView.html">ContinuousSwatchView</a></li><li><a href="LayerLegendView.html">LayerLegendView</a></li><li><a href="LegendContainerView.html">LegendContainerView</a></li><li class='category-heading' data-category='Views/Maps/Viewfinder'>Views/Maps/Viewfinder</li><li><a href="ExpansionPanelView.html">ExpansionPanelView</a></li><li><a href="ZoomPresetView.html">ZoomPresetView</a></li><li><a href="ZoomPresetsListView.html">ZoomPresetsListView</a></li><li class='category-heading' data-category='Views/Metadata'>Views/Metadata</li><li><a href="AutofillAttributesView.html">AutofillAttributesView</a></li><li><a href="EML211EditorView.html">EML211EditorView</a></li><li><a href="EMLAttributeView.html">EMLAttributeView</a></li><li><a href="EMLAttributesView.html">EMLAttributesView</a></li><li><a href="EMLEntityView.html">EMLEntityView</a></li><li><a href="EMLMeasurementScaleView.html">EMLMeasurementScaleView</a></li><li><a href="EMLMeasurementTypeView.html">EMLMeasurementTypeView</a></li><li><a href="EMLMethodsView.html">EMLMethodsView</a></li><li><a href="EMLMissingValueCodeView.html">EMLMissingValueCodeView</a></li><li><a href="EMLMissingValueCodesView.html">EMLMissingValueCodesView</a></li><li><a href="EMLOtherEntityView.html">EMLOtherEntityView</a></li><li><a href="EMLPartyView.html">EMLPartyView</a></li><li><a href="EMLTempCoverageView.html">EMLTempCoverageView</a></li><li><a href="EMLView.html">EMLView</a></li><li><a href="EMlGeoCoverageView_.html">EMlGeoCoverageView</a></li><li><a href="ScienceMetadataView.html">ScienceMetadataView</a></li><li class='category-heading' data-category='Views/Ontologies'>Views/Ontologies</li><li><a href="BioontologyBrowser.html">BioontologyBrowser</a></li><li class='category-heading' data-category='Views/Portals'>Views/Portals</li><li><a href="PortalDataView.html">PortalDataView</a></li><li><a href="PortalHeaderView.html">PortalHeaderView</a></li><li><a href="PortalListView.html">PortalListView</a></li><li><a href="PortalLogosView.html">PortalLogosView</a></li><li><a href="PortalMembersView.html">PortalMembersView</a></li><li><a href="PortalSectionView.html">PortalSectionView</a></li><li><a href="PortalUsagesView.html">PortalUsagesView</a></li><li><a href="PortalView.html">PortalView</a></li><li><a href="PortalVisualizationsView.html">PortalVisualizationsView</a></li><li><a href="PortalsSearchView.html">PortalsSearchView</a></li><li class='category-heading' data-category='Views/Portals/Editor'>Views/Portals/Editor</li><li><a href="PortEditorDataView.html">PortEditorDataView</a></li><li><a href="PortEditorImageView.html">PortEditorImageView</a></li><li><a href="PortEditorLogosView.html">PortEditorLogosView</a></li><li><a href="PortEditorMdSectionView.html">PortEditorMdSectionView</a></li><li><a href="PortEditorSectionView.html">PortEditorSectionView</a></li><li><a href="PortEditorSectionsView.html">PortEditorSectionsView</a></li><li><a href="PortEditorSettingsView.html">PortEditorSettingsView</a></li><li><a href="PortalEditorView.html">PortalEditorView</a></li><li class='category-heading' data-category='Views/Projects'>Views/Projects</li><li><a href="ProjectView.html">ProjectView</a></li><li class='category-heading' data-category='Views/QueryBuilder'>Views/QueryBuilder</li><li><a href="QueryBuilderView.html">QueryBuilderView</a></li><li><a href="QueryRuleView.html">QueryRuleView</a></li><li class='category-heading' data-category='Views/Search'>Views/Search</li><li><a href="SearchResultsPagerView.html">SearchResultsPagerView</a></li><li><a href="SearchResultsView.html">SearchResultsView</a></li><li><a href="SorterView.html">SorterView</a></li><li class='category-heading' data-category='Views/SearchSelect'>Views/SearchSelect</li><li><a href="AccountSelectView.html">AccountSelectView</a></li><li><a href="AnnotationFilter.html">AnnotationFilter</a></li><li><a href="BioontologySelectView.html">BioontologySelectView</a></li><li><a href="NodeSelect.html">NodeSelect</a></li><li><a href="ObjectFormatSelect.html">ObjectFormatSelect</a></li><li><a href="QueryFieldSelectView.html">QueryFieldSelectView</a></li><li><a href="SearchSelectView.html">SearchSelectView</a></li><li><a href="SeparatorView.html">SeparatorView</a></li><li class='category-heading' data-category='Views/UIElements'>Views/UIElements</li><li><a href="ToggleView.html">ToggleView</a></li><li><a href="EMLTaxonView.html">EMLTaxonView</a></li><li><a href="EventLog.html">EventLog</a></li><li><a href="SystemMetadata.html">SystemMetadata</a></li><li class='category-heading' data-category='Deprecated'>Deprecated</li><li><a href="AnnotatorView.html">AnnotatorView</a></li><li><a href="ExternalView.html">ExternalView</a></li><li><a href="LogsSearch.html">LogsSearch</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addClassesFromResponse">addClassesFromResponse</a></li><li><a href="global.html#addFields">addFields</a></li><li><a href="global.html#addSelected">addSelected</a></li><li><a href="global.html#adjustDescriptionLength">adjustDescriptionLength</a></li><li><a href="global.html#appConfigPath">appConfigPath</a></li><li><a href="global.html#buildChildrenUrl">buildChildrenUrl</a></li><li><a href="global.html#buildSearchUrl">buildSearchUrl</a></li><li><a href="global.html#canChangeSeparator">canChangeSeparator</a></li><li><a href="global.html#changeSubmenuOnSearch">changeSubmenuOnSearch</a></li><li><a href="global.html#couldBeLatLong">couldBeLatLong</a></li><li><a href="global.html#createBatchPayload">createBatchPayload</a></li><li><a href="global.html#createHeaders">createHeaders</a></li><li><a href="global.html#defaults">defaults</a></li><li><a href="global.html#encodeIfPresent">encodeIfPresent</a></li><li><a href="global.html#excludeFields">excludeFields</a></li><li><a href="global.html#fetchClasses">fetchClasses</a></li><li><a href="global.html#fetchClassesFromOntology">fetchClassesFromOntology</a></li><li><a href="global.html#fetchFromOntologies">fetchFromOntologies</a></li><li><a href="global.html#fetchQueryFields">fetchQueryFields</a></li><li><a href="global.html#fieldToOption">fieldToOption</a></li><li><a href="global.html#filterClassesToFetch">filterClassesToFetch</a></li><li><a href="global.html#finalizeFetch">finalizeFetch</a></li><li><a href="global.html#formatResult">formatResult</a></li><li><a href="global.html#formatResults">formatResults</a></li><li><a href="global.html#generateGeoJSONPoint">generateGeoJSONPoint</a></li><li><a href="global.html#generateGeoJSONPolygon">generateGeoJSONPolygon</a></li><li><a href="global.html#generateGeoJSONString">generateGeoJSONString</a></li><li><a href="global.html#generateIdentifier">generateIdentifier</a></li><li><a href="global.html#generateSpatialCoverage">generateSpatialCoverage</a></li><li><a href="global.html#getAccountDetails">getAccountDetails</a></li><li><a href="global.html#getCachedClasses">getCachedClasses</a></li><li><a href="global.html#getCategoryNames">getCategoryNames</a></li><li><a href="global.html#getChildren">getChildren</a></li><li><a href="global.html#getClasses">getClasses</a></li><li><a href="global.html#getDOIURL">getDOIURL</a></li><li><a href="global.html#getIncludeParam">getIncludeParam</a></li><li><a href="global.html#getNextPage">getNextPage</a></li><li><a href="global.html#getNextSeparator">getNextSeparator</a></li><li><a href="global.html#getOptionByLabelOrValue">getOptionByLabelOrValue</a></li><li><a href="global.html#getOptionsByCategory">getOptionsByCategory</a></li><li><a href="global.html#getQueryFieldOptions">getQueryFieldOptions</a></li><li><a href="global.html#getSelectedModels">getSelectedModels</a></li><li><a href="global.html#hasInvalidSelections">hasInvalidSelections</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#initializeFetch">initializeFetch</a></li><li><a href="global.html#isValidValue">isValidValue</a></li><li><a href="global.html#model">model</a></li><li><a href="global.html#moveClassesToNotFound">moveClassesToNotFound</a></li><li><a href="global.html#optionsAsJSON">optionsAsJSON</a></li><li><a href="global.html#padDescription">padDescription</a></li><li><a href="global.html#parse">parse</a></li><li><a href="global.html#recordError">recordError</a></li><li><a href="global.html#removeSelected">removeSelected</a></li><li><a href="global.html#renameCategory">renameCategory</a></li><li><a href="global.html#reset">reset</a></li><li><a href="global.html#resetPageInfo">resetPageInfo</a></li><li><a href="global.html#responseAsync">responseAsync</a></li><li><a href="global.html#restoreTypes">restoreTypes</a></li><li><a href="global.html#separatorRequired">separatorRequired</a></li><li><a href="global.html#serialize">serialize</a></li><li><a href="global.html#setAddedFieldDetails">setAddedFieldDetails</a></li><li><a href="global.html#setDataCatalogSchema">setDataCatalogSchema</a></li><li><a href="global.html#setDatasetSchema">setDatasetSchema</a></li><li><a href="global.html#setNextSeparator">setNextSeparator</a></li><li><a href="global.html#setOptionsForPreselected">setOptionsForPreselected</a></li><li><a href="global.html#setSchema">setSchema</a></li><li><a href="global.html#setSchemaFromTemplate">setSchemaFromTemplate</a></li><li><a href="global.html#setSelected">setSelected</a></li><li><a href="global.html#sortByProp">sortByProp</a></li><li><a href="global.html#sortFields">sortFields</a></li><li><a href="global.html#toAccordionItem">toAccordionItem</a></li><li><a href="global.html#toJSON">toJSON</a></li><li><a href="global.html#toSearchSelectOption">toSearchSelectOption</a></li><li><a href="global.html#truncateDescription">truncateDescription</a></li><li><a href="global.html#updateOptions">updateOptions</a></li><li><a href="global.html#url">url</a></li><li><a href="global.html#waitForFetchComplete">waitForFetchComplete</a></li></ul>
</nav>

<div id="main">

    <h1 class="page-title">Source: src/js/views/portals/PortalView.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>define([
  "jquery",
  "underscore",
  "backbone",
  "models/portals/PortalModel",
  "models/UserModel",
  "text!templates/alert.html",
  "text!templates/loading.html",
  "text!templates/portals/portal.html",
  "text!templates/portals/editPortals.html",
  "views/portals/PortalHeaderView",
  "views/portals/PortalDataView",
  "views/portals/PortalSectionView",
  "views/portals/PortalMetricsView",
  "views/portals/PortalMembersView",
  "views/portals/PortalLogosView",
  "views/portals/PortalVisualizationsView",
], (
  $,
  _,
  Backbone,
  Portal,
  User,
  AlertTemplate,
  LoadingTemplate,
  PortalTemplate,
  EditPortalsTemplate,
  PortalHeaderView,
  PortalDataView,
  PortalSectionView,
  PortalMetricsView,
  PortalMembersView,
  PortalLogosView,
  PortalVisualizationsView,
) => {
  "use_strict";

  /**
   * @class PortalView
   * @classdesc The PortalView is a generic view to render
   * portals, it will hold portal sections
   * @classcategory Views/Portals
   * @extends Backbone.View
   * @constructor
   */
  const PortalView = Backbone.View.extend(
    /** @lends PortalView.prototype */ {
      /**
       * The Portal element
       * @type {string}
       */
      el: "#Content",

      /**
       * The type of View this is
       * @type {string}
       */
      type: "Portal",

      /**
       * The currently active section view
       * @type {PortalSectionView}
       */
      activeSection: undefined,

      /**
       * The currently active section label. e.g. Data, Metrics, Settings, etc.
       * @type {string}
       */
      activeSectionLabel: "",

      /**
       * The names of all sections in this portal editor
       * @type {Array}
       */
      sectionNames: [],

      /**
       * The seriesId of the portal document
       * @type {string}
       */
      portalId: "",

      /**
       * The unique short name of the portal
       * @type {string}
       */
      label: "",

      /**
       * Flag to add section name to URL. Enabled by default.
       * @type {boolean}
       */
      displaySectionInUrl: true,

      /**
       * The subviews contained within this view to be removed with onClose
       * @type {Array}
       */
      subviews: new Array(), // Could be a literal object {} */

      /**
       * A reference to the Portal Logos View that displays the logos of this portal.
       * @type PortalLogosView
       */
      logosView: null,

      /**
       * A Portal Model is associated with this view and gets created during render()
       * @type {Portal}
       */
      model: null,

      /**
       * A User Model is associated with this view for rendering node/user views
       * @type {User}
       */
      userModel: null,

      /* Renders the compiled template into HTML */
      template: _.template(PortalTemplate),
      //A template to display a notification message
      alertTemplate: _.template(AlertTemplate),
      //A template for displaying a loading message
      loadingTemplate: _.template(LoadingTemplate),
      // Template for the 'edit portal' button
      editPortalsTemplate: _.template(EditPortalsTemplate),

      /**
       * A jQuery selector for the element that a single section link will be inserted into
       * @type {string}
       */
      sectionLinkContainer: ".section-link-container",
      /**
       * A jQuery selector for the elements that are links to the individual sections
       * @type {string}
       */
      sectionLinks: ".portal-section-link",
      /**
       * A jQuery selector for the section elements
       * @type {string}
       */
      sectionEls: ".portal-section-view",
      /**
       * A jQuery selection for the element that will contain the Edit button.
       * @type {string}
       * @since 2.14.0
       */
      editButtonContainer: ".edit-portal-link-container",
      /**
       * The events this view will listen to and the associated function to call.
       * @type {Object}
       */
      events: {
        "click .portal-section-link": "handleSwitchSection",
        "click .section-links-container": "toggleSectionLinks",
      },

      /**
       * Is executed when a new PortalView is created
       */
      initialize(options) {
        // Set the current PortalView properties
        this.portalId = options.portalId ? options.portalId : undefined;
        this.model = options.model ? options.model : undefined;
        this.nodeView = options.nodeView ? options.nodeView : undefined;
        this.label = options.label ? options.label : undefined;
        this.activeSection = options.activeSection
          ? options.activeSection
          : undefined;
        this.activeSectionLabel = options.activeSectionLabel
          ? options.activeSectionLabel
          : undefined;
      },

      /**
       * Initial render of the PortalView
       *
       * @return {PortalView} Returns itself for easy function stacking in the app
       */
      render() {
        const view = this;

        // Make sure the subviews array is reset
        this.subviews = new Array();

        // Add the overall class immediately so the navbar is styled correctly right away
        $("body").addClass("PortalView");

        this.$el.html(
          this.loadingTemplate({
            msg: "Loading...",
          }),
        );

        // Perform specific label checks
        if (!MetacatUI.nodeModel.get("checked")) {
          this.listenToOnce(MetacatUI.nodeModel, "change:checked", () => {
            // perform node checks
            if (view.isNode(view.label)) {
              view.nodeView = true;
              view.renderAsNode();
            } else {
              view.nodeView = false;
              view.renderAsPortal();
            }
          });

          this.listenToOnce(MetacatUI.nodeModel, "error", () => {
            this.showError(null, "Couldn't get the DataONE Node info document");
          });
        } else if (MetacatUI.nodeModel.get("error")) {
          this.showError(null, "Couldn't get the DataONE Node info document");
        } else if (this.isNode(this.label)) {
          this.nodeView = true;
          this.renderAsNode();
        } else if (!this.isNode(this.label)) {
          this.nodeView = false;
          this.renderAsPortal();
        }

        return this;
      },

      /**
       * Entry point for portal rendering
       */
      renderAsPortal() {
        // At this point we know that the given label is not a
        // repository short identifier

        // Create a new Portal model
        if (this.model === undefined || this.model === null) {
          this.model = new Portal({
            seriesId: this.portalId,
            label: this.label,
          });
        }

        // When the model has been synced, render the results
        this.stopListening();
        this.listenToOnce(this.model, "sync", this.renderPortal);

        //If the portal isn't found, display a 404 message
        this.listenTo(this.model, "notFound", this.handleNotFound);

        //Listen to errors that might occur during fetch()
        this.listenToOnce(this.model, "error", this.showError);

        //Fetch the model
        this.model.fetch({ objectOnly: true });
      },

      /**
       * Entry point for a repository portal view
       * At this point we know for sure that a given label/username is a repository user
       */
      renderAsNode() {
        const view = this;

        // Create a UserModel with the username given
        this.userModel = new User({
          username: view.label,
        });
        this.userModel.saveAsNode();
        // get the node Info
        const nodeInfo = _.find(
          MetacatUI.nodeModel.get("members"),
          (nodeModel) =>
            nodeModel.identifier.toLowerCase() ===
            `urn:node:${view.label.toLowerCase()}`,
        );
        this.nodeInfo = nodeInfo;
        this.nodeName = this.nodeInfo.name;
        this.portalId = this.nodeInfo.identifier;

        // create a portal model for repository
        this.model = new Portal({
          seriesId: this.portalId,
          label: view.label,
          name: this.nodeInfo.name,
          description: this.nodeInfo.description,
        });

        // remove the members section directly from the model
        this.model.removeSection("members");

        this.model.createNodeAttributes(this.nodeInfo);

        // Setting the repo specific statsModel
        const statsSearchModel = this.userModel.get("searchModel").clone();
        statsSearchModel
          .set("exclude", [], { silent: true })
          .set("formatType", [], { silent: true });
        MetacatUI.statsModel.set("query", statsSearchModel.getQuery());
        MetacatUI.statsModel.set("searchModel", statsSearchModel);

        if (
          _.contains(
            MetacatUI.appModel.get("dataoneHostedRepos"),
            this.nodeInfo.identifier,
          )
        ) {
          MetacatUI.statsModel.set("mdqImageId", this.nodeInfo.identifier);
        }

        // render repository view as portal view
        this.renderPortal();
      },

      /**
       * Render the Portal view
       */
      renderPortal() {
        // Set the document title to the portal name
        MetacatUI.appModel.set("title", this.model.get("name"));
        MetacatUI.appModel.set("description", this.model.get("description"));

        // Getting the correct portal label and seriesID
        this.label = this.model.get("label");
        this.portalId = this.model.get("seriesId");

        // Remove the listeners that were set during the fetch() process
        this.stopListening(this.model, "notFound", this.handleNotFound);
        this.stopListening(this.model, "error", this.showError);

        //If this is in DataONE Plus Preview Mode, check that the portal is
        // a Plus portal before rendering. Member Node portals are always displayed.
        if (
          MetacatUI.appModel.get("dataonePlusPreviewMode") &amp;&amp;
          !this.nodeView
        ) {
          const sourceMN = this.model.get("datasource");

          //Check if the portal source node is from the active alt repo OR is
          // configured as a Plus portal.
          if (
            typeof sourceMN != "string" ||
            (sourceMN !=
              MetacatUI.appModel.get("defaultAlternateRepositoryId") &amp;&amp;
              !_.findWhere(
                MetacatUI.appModel.get("dataonePlusPreviewPortals"),
                { datasource: sourceMN, seriesId: this.model.get("seriesId") },
              ))
          ) {
            //Get the name of the source member node
            const sourceMNName = "original data repository",
              mnURL = "";
            if (typeof sourceMN == "string") {
              const sourceMNObject = MetacatUI.nodeModel.getMember(sourceMN);
              if (sourceMNObject) {
                sourceMNName = sourceMNObject.name;

                //If there is a baseURL string
                if (sourceMNObject.baseURL) {
                  //Parse out the origin of the baseURL string. We want to crop out the /metacat/d1/mn parts.
                  mnURL =
                    sourceMNObject.baseURL.substring(
                      0,
                      sourceMNObject.baseURL.lastIndexOf("."),
                    ) +
                    sourceMNObject.baseURL.substring(
                      sourceMNObject.baseURL.lastIndexOf("."),
                      sourceMNObject.baseURL.indexOf(
                        "/",
                        sourceMNObject.baseURL.lastIndexOf("."),
                      ),
                    );
                }
              }
            }

            //Show a message that the portal can be found on the repository website.
            const message = $(document.createElement("h3")).addClass(
              "center stripe",
            );
            message.text(
              "The " +
                this.model.get("name") +
                " " +
                MetacatUI.appModel.get("portalTermSingular") +
                " can be viewed in the ",
            );

            if (mnURL) {
              message.append(
                $(document.createElement("a"))
                  .attr("href", mnURL)
                  .attr("target", "_blank")
                  .text(sourceMNName),
              );
            } else {
              message.append(sourceMNName);
            }

            this.$el.html(message);

            return;
          }
        }

        // Check for theme/layout settings and add the required files
        this.addTheming();

        // Insert the overall portal template
        this.$el.html(this.template(this.model.toJSON()));

        // Render the header view
        this.headerView = new PortalHeaderView({
          model: this.model,
          nodeView: this.nodeView,
        });
        this.headerView.render();
        this.subviews.push(this.headerView);

        // only displaying the edit button for non-repository profiles
        if (!this.nodeView) {
          // Add edit button if user is authorized
          this.insertOwnerControls();
        }

        // Render the content sections
        _.each(
          this.model.get("sections"),
          function (section) {
            this.addSection(section);
          },
          this,
        );

        // Render the Data section
        if (this.model.get("hideData") !== true) {
          this.sectionDataView = new PortalDataView({
            model: this.model,
            sectionName: "Data",
            id: "Data",
            nodeView: this.nodeView,
          });
          this.subviews.push(this.sectionDataView);

          this.$("#portal-sections").append(this.sectionDataView.el);

          //Render the section view and add it to the page
          this.sectionDataView.render();

          this.addSectionLink(this.sectionDataView);
        }

        //Render the metrics section link
        if (this.model.get("hideMetrics") !== true) {
          //Create a PortalMetricsView
          this.metricsView = new PortalMetricsView({
            model: this.model,
            id: this.model.get("metricsLabel"),
            uniqueSectionName: this.model.get("metricsLabel"),
            nodeView: this.nodeView,
            nodeName: this.nodeName,
          });

          this.subviews.push(this.metricsView);
          this.$("#portal-sections").append(this.metricsView.el);

          this.metricsView.render();

          this.addSectionLink(this.metricsView);
        }

        // Render the members section
        if (
          this.model.get("hideMembers") !== true &amp;&amp;
          (this.model.get("associatedParties").length ||
            this.model.get("acknowledgments"))
        ) {
          this.sectionMembersView = new PortalMembersView({
            model: this.model,
            id: "Members",
            sectionName: "Members",
          });
          this.subviews.push(this.sectionMembersView);

          this.$("#portal-sections").append(this.sectionMembersView.el);

          //Render the section view and add it to the page
          this.sectionMembersView.render();

          this.addSectionLink(this.sectionMembersView);
        }

        // Render the logos at the bottom of the portal page
        const ackLogos = this.model.get("acknowledgmentsLogos") || [];
        if (ackLogos.length) {
          this.logosView = new PortalLogosView();
          this.logosView.logos = ackLogos;
          this.subviews.push(this.logosView);
          this.logosView.render();
          this.$(".portal-view").append(this.logosView.el);
        }

        // Re-order the section tabs according the the portal editor's preference,
        // if one has been set
        try {
          const pageOrder = this.model.get("pageOrder");
          if (pageOrder &amp;&amp; pageOrder.length) {
            const linksContainer = this.el.querySelector(
              "#portal-section-tabs",
            );
            const sortableLinks = this.el.querySelectorAll(
              "#portal-section-tabs .section-link-container",
            );
            const sortableLinksArray = Array.prototype.slice.call(
              sortableLinks,
              0,
            );
            // sort the links according the pageOrder
            sortableLinksArray.sort((a, b) => {
              const aName = $(a).text();
              const bName = $(b).text();
              const aIndex = pageOrder.indexOf(aName);
              const bIndex = pageOrder.indexOf(bName);
              // If the label can't be found in the list of labels, place it at the end
              if (bIndex === -1) {
                return +1;
              }
              if (aIndex === -1) {
                return -1;
              }
              // Sort backwards, because we use preprend
              return bIndex - aIndex;
            });
            // Rearrange the links in the DOM
            for (i = 0; i &lt; sortableLinksArray.length; ++i) {
              linksContainer.prepend(sortableLinksArray[i]);
            }
          }
        } catch (error) {
          console.log(
            "Error re-arranging tabs according to the pageOrder option. Error message: " +
              error,
          );
        }

        //Switch to the active section
        this.switchSection();

        //Scroll to an inner-page link if there is one specified
        if (window.location.hash &amp;&amp; this.$(window.location.hash).length) {
          MetacatUI.appView.scrollTo(this.$(window.location.hash));
        }

        // Save reference to this view
        const view = this;

        // On mobile, hide section tabs a moment after page loads so
        // users notice where they are
        setTimeout(function () {
          view.toggleSectionLinks();
        }, 700);

        // On mobile where the section-links-container is set to fixed,
        // hide the portal navigation element when user scrolls down,
        // show again when the user scrolls up.
        MetacatUI.appView.prevScrollpos = window.pageYOffset;
        $(window).on("scroll", "", undefined, this.handleScroll);
      },

      /**
       * Checks the portal model for theme or layout options. If there are any, and if
       * they are supported, then add the associated CSS.
       */
      addTheming() {
        try {
          // Check for theme and layout settings.
          const theme = this.model.get("theme");
          const layout = this.model.get("layout");
          // TODO: make supported themes an app model config option?
          const supportedThemes = ["dark", "light"];
          const supportedLayouts = ["panels"];
          // We must remove theme/layout CSS when the user navigates away from the
          // portal in onClose(). To do this, we need to keep track of which CSS is
          // added during this step.
          const view = this;
          view.addedThemeCSS = [];
          // Layout should be added before theme for CSS rules to work together properly
          // when there is a theme + layout
          if (layout &amp;&amp; supportedLayouts.includes(layout)) {
            require([
              "text!" +
                MetacatUI.root +
                "/css/portal-layouts/" +
                layout +
                ".css",
            ], function (ThemeCss) {
              const cssID = "portal-layout-" + layout;
              MetacatUI.appModel.addCSS(ThemeCss, cssID);
              view.addedThemeCSS.push(cssID);
            });
          }
          if (theme &amp;&amp; supportedThemes.includes(theme)) {
            require([
              "text!" + MetacatUI.root + "/css/portal-themes/" + theme + ".css",
            ], function (ThemeCss) {
              const cssID = "portal-theme-" + theme;
              MetacatUI.appModel.addCSS(ThemeCss, cssID);
              view.addedThemeCSS.push(cssID);
            });
          }
        } catch (error) {
          console.log(
            "There was an error adding theme and/or layout styles in a PortalView" +
              ". Error details: " +
              error,
          );
        }
      },

      /**
       * toggleSectionLinks - show or hide the section links nav. Used for
       * mobile/small screens only.
       */
      toggleSectionLinks() {
        try {
          // Only toggle the section links on mobile. On mobile, the
          // ".show-sections-toggle" is visible.
          if (this.$(".show-sections-toggle").is(":visible")) {
            this.$("#portal-section-tabs").slideToggle();
          }
        } catch (e) {
          console.log("Failed to toggle section links, error message: " + e);
        }
      },

      /*
       * Checks the authority for the logged in user for this portal and
       * inserts control elements onto the page for the user to interact
       * with the portal. So far, this is just an 'edit portal' button.
       */
      insertOwnerControls() {
        // Insert the button into the navbar
        const container = $(this.editButtonContainer);

        const model = this.model;

        this.listenToOnce(this.model, "change:isAuthorized", function () {
          if (!model.get("isAuthorized")) {
            return false;
          } else {
            container.html(
              this.editPortalsTemplate({
                editButtonText:
                  "Edit " + MetacatUI.appModel.get("portalTermSingular"),
                pathToEdit:
                  MetacatUI.root +
                  "/edit/" +
                  MetacatUI.appModel.get("portalTermPlural") +
                  "/" +
                  model.get("label"),
              }),
            );
          }
        });

        this.model.checkAuthority("write");
      },

      /**
       * Update the window location path with the active section name
       * @param {boolean} [showSectionLabel] - If true, the section label will be added to the path
       * @param {boolean} [retainSearchQuery] Whether to keep the search query
       * params during a path change. These should be kept when the page is
       * loading initially.
       */
      updatePath(showSectionLabel, retainSearchQuery) {
        const label = this.model.get("label") || this.newPortalTempName;
        const originalLabel =
          this.model.get("originalLabel") || this.newPortalTempName;
        const pathName = decodeURIComponent(window.location.pathname)
          .substring(MetacatUI.root.length)
          // remove trailing forward slash if one exists in path
          .replace(/\/$/, "");

        // Add or replace the label and section part of the path with updated values.
        // pathRE matches "/label/section", where the "/section" part is optional
        const pathRE = new RegExp(
          "\\/(" + label + "|" + originalLabel + ")(\\/[^\\/]*)?$",
          "i",
        );
        let newPathName = pathName.replace(pathRE, "") + "/" + label;

        if (showSectionLabel &amp;&amp; this.activeSection) {
          newPathName += "/" + this.activeSection.uniqueSectionLabel;
        }

        const searchQueryString = new URL(window.location.href).search;
        // Support optional parameters for loading a portal's view from URL.
        if (retainSearchQuery &amp;&amp; searchQueryString) {
          newPathName += searchQueryString;
        }

        // Update the window location
        MetacatUI.uiRouter.navigate(newPathName, { trigger: false });

        this.model.reportSectionChange(this.activeSection?.model);
      },

      /**
       * Gets a list of section names from tab elements and updates the
       * sectionNames attribute on this view.
       */
      updateSectionNames() {
        // Get the section names from the tab elements
        const sectionNames = [];
        this.$(this.sectionLinks).each((i, anchorEl) => {
          sectionNames[i] = $(anchorEl).attr("href").substring(1);
        });

        // Set the array of sectionNames on the view
        this.sectionNames = sectionNames;
      },

      /**
       * Manually switch to a section subview by making the tab and tab panel active.
       * Navigation between sections is usually handled automatically by the Bootstrap
       * library, but a manual switch may be necessary sometimes
       * @param {PortalSectionView} [portalSectionView] - The section view to switch to. If not given, defaults to the activeSection set on the view.
       */
      switchSection(portalSectionView) {
        // Create a flag for whether the section label should be shown in the URL
        let showSectionLabelInURL = true;
        let sectionView = portalSectionView;

        // If no section view is given, use the active section in the view.
        if (!sectionView) {
          // Use the sectionView set already
          if (this.activeSection) {
            sectionView = this.activeSection;
          }
          // Or find the section view by name, which may have been passed through the URL
          else if (this.activeSectionLabel) {
            sectionView = this.getSectionByLabel(this.activeSectionLabel);
          }
        }

        // If no section view was indicated, just default to the first visible one
        if (!sectionView) {
          sectionView = this.$(this.sectionLinkContainer).first().data("view");

          // If we are defaulting to the first section, don't show the section label in the URL
          showSectionLabelInURL = false;

          // If there are no section views on the page at all, exit now
          if (!sectionView) {
            return;
          }
        }

        // Update the activeSection set on the view
        this.activeSection = sectionView;

        // Activate the section content
        this.$(this.sectionEls).each((i, contentEl) => {
          if ($(contentEl).data("view") == sectionView) {
            $(contentEl).addClass("active");
          } else {
            // make sure no other sections are active
            $(contentEl).removeClass("active");
          }
        });

        // Activate the link to the content
        this.$(this.sectionLinkContainer).each((i, linkEl) => {
          if ($(linkEl).data("view") == sectionView) {
            $(linkEl).addClass("active");
          } else {
            // make sure no other sections are active
            $(linkEl).removeClass("active");
          }
        });

        // If the section view has post-render functionality, execute it now
        if (typeof sectionView.postRender == "function") {
          sectionView.postRender();
        }

        // Eventually, the panels layout will allow showing multiple sections at the
        // same time in different panels. For now, the visualizations sections should
        // take up the full height of the viewport (minus the header elements), and the
        // footer should be hidden.
        if (
          this.model.get("layout") === "panels" &amp;&amp;
          sectionView instanceof PortalVisualizationsView
        ) {
          if (this.logosView) {
            this.logosView.el.style.setProperty("display", "none");
          }
          if (MetacatUI.footerView) {
            MetacatUI.footerView.hide();
          }
        } else {
          if (this.logosView) {
            this.logosView.el.style.removeProperty("display");
          }
          if (MetacatUI.footerView) {
            MetacatUI.footerView.show();
          }
        }

        if (!this.nodeView) {
          // Update the location path with the new section name
          this.updatePath(
            showSectionLabelInURL,
            // portalSectionView is undefined on initial page load, so keep the
            // search query parameters that the user expects.
            /* retainSearchQuery= */ !portalSectionView,
          );
        }
      },

      /**
       * When a section link has been clicked, switch to that section
       * @param {Event} e - The click event on the section link
       */
      handleSwitchSection(e) {
        e.preventDefault();

        const sectionView = $(e.target)
          .parents(this.sectionLinkContainer)
          .first()
          .data("view");

        if (sectionView) {
          this.switchSection(sectionView);

          // If the user clicks a link and is not near the top of the page
          // (i.e. on mobile), scroll to the top of the section content.
          // Otherwise it might look like the page hasn't changed (e.g.
          // when focus is on the footer)
          if (window.pageYOffset > this.$("#portal-sections").offset().top) {
            MetacatUI.appView.scrollTo(this.$("#portal-sections"));
          }
        }
      },

      /**
       * Returns the section view that has a label matching the one given.
       * @param {string} label - The label for the section
       * @return {PortalSectionView|false} - Returns false if a matching section view isn't found
       */
      getSectionByLabel(label) {
        //If no label is given, exit
        if (!label) {
          return;
        }

        //Find the section view whose unique label matches the given label. Case-insensitive matching.
        return _.find(this.subviews, function (view) {
          if (typeof view.uniqueSectionLabel == "string") {
            return view.uniqueSectionLabel.toLowerCase() == label.toLowerCase();
          } else {
            return false;
          }
        });
      },

      /**
       * Creates and returns a unique label for the given section. This label is just used in the view,
       * because portal sections can have duplicate labels. But unique labels need to be used for navigation in the view.
       * @param {PortEditorSection} sectionModel - The section for which to create a unique label
       * @return {string} The unique label string
       */
      getUniqueSectionLabel(sectionModel) {
        //Get the label for this section
        const sectionLabel = sectionModel
            .get("label")
            .replace(/[^a-zA-Z0-9 ]/g, "")
            .replace(/ /g, "-"),
          unalteredLabel = sectionLabel,
          sectionLabels = this.sectionLabels || [],
          i = 2;

        //Concatenate a number to the label if this one already exists
        while (sectionLabels.includes(sectionLabel)) {
          sectionLabel = unalteredLabel + i;
          i++;
        }

        return sectionLabel;
      },

      /**
       * Creates a PortalSectionView to display the content in the given portal
       * section. Also creates a navigation link to the section.
       *
       * @param {PortalSectionModel} sectionModel - The section to render in this view
       */
      addSection(sectionModel) {
        //If this is a visualization Section, render it differently with PortalVizSectionView
        if (sectionModel.get("sectionType") == "visualization") {
          this.addVizSection(sectionModel);
          return;
        }
        //All other portal section types are rendered with the basic PortalSectionView
        else {
          //Create a new PortalSectionView
          const sectionView = new PortalSectionView({
            model: sectionModel,
          });

          //Render the section
          sectionView.render();

          //Add the section view to this portal view
          this.$("#portal-sections").append(sectionView.el);

          this.addSectionLink(sectionView);

          //Create a unique label for this section and save it
          const uniqueLabel = this.getUniqueSectionLabel(sectionModel);
          //Set the unique section label for this view
          sectionView.uniqueSectionLabel = uniqueLabel;

          this.subviews.push(sectionView);
        }
      },

      /**
       * Creates a PortalSectionView to display the content in the given portal
       * section. Also creates a navigation link to the section.
       * @param {PortalVizSectionModel} sectionModel - The visualization section to render in this view
       *
       */
      addVizSection(sectionModel) {
        //Create a new PortalSectionView
        const sectionView = new PortalVisualizationsView({
          model: sectionModel,
        });

        //Render the section
        sectionView.render();

        //Add the section view to this portal view
        this.$("#portal-sections").append(sectionView.el);

        this.addSectionLink(sectionView);

        //Create a unique label for this section and save it
        const uniqueLabel = this.getUniqueSectionLabel(sectionModel);

        //Set the unique section label for this view
        sectionView.uniqueSectionLabel = uniqueLabel;

        this.subviews.push(sectionView);
      },

      /**
       * Add a link to a section of this portal page
       * @param {PortalSectionView} sectionView - The view to add a link to
       */
      addSectionLink(sectionView) {
        const label = sectionView.getName();
        const hrefLabel = sectionView.getName({ linkFriendly: true });

        //Create a navigation link
        this.$("#portal-section-tabs").append(
          $(document.createElement("li"))
            .addClass("section-link-container")
            .data("view", sectionView)
            .append(
              $(document.createElement("a"))
                .text(label)
                .attr("href", "#" + hrefLabel)
                .attr("data-toggle", "tab")
                .addClass("portal-section-link")
                .data("view", sectionView),
            ),
        );
      },

      /**
       * Handles the case where the PortalModel is fetched and nothing is found.
       */
      handleNotFound() {
        const view = this;

        // If the user is NOT logged in OR
        // if the user is logged in, and the last fetch was done with user credentials, then this Portal is either not accessible or non-existent
        if (
          (MetacatUI.appUserModel.get("checked") &amp;&amp;
            !MetacatUI.appUserModel.get("loggedIn")) ||
          (MetacatUI.appUserModel.get("checked") &amp;&amp;
            MetacatUI.appUserModel.get("loggedIn") &amp;&amp;
            this.model.get("fetchedWithAuth"))
        ) {
          //Check if there is an indexing queue, because this model may still be indexing
          const onError = function () {
              //If the request to the monitor/status API fails, then show the not-found message
              view.showNotFound.call(view);
            },
            onSuccess = function (sizeOfQueue) {
              if (sizeOfQueue > 0) {
                //Show a warning message about the index queue
                MetacatUI.appView.showAlert(
                  "&lt;p>We couldn't find a data portal named \" &lt;span id='portal-view-not-found-name'>&lt;/span>" +
                    "\".&lt;/p>&lt;p>&lt;i class='icon icon-exclamation-sign'>&lt;/i> If this portal was created in the last few minutes, it may still be processing, since there are currently &lt;b>" +
                    sizeOfQueue +
                    "&lt;/b> submissions in the queue.&lt;/p>",
                  "alert-warning",
                  view.$el,
                );
                view.$(".loading").remove();

                view
                  .$("#portal-view-not-found-name")
                  .text(view.label || view.portalId);
              } else {
                //If the size of the queue is 0, then show the not-found message
                view.showNotFound.call(view);
              }
            };

          //Get the size of the index queue
          MetacatUI.appLookupModel.getSizeOfIndexQueue(onSuccess, onError);
        }
        //If the user IS logged in and we haven't fetched the model with user authentication yet
        else if (
          MetacatUI.appUserModel.get("checked") &amp;&amp;
          MetacatUI.appUserModel.get("loggedIn")
        ) {
          //Fetch again now that the user is logged in
          this.model.fetch();
        }
        //If the user login status is unknown, because authentication is still pending
        else if (!MetacatUI.appUserModel.get("checked")) {
          //Wait for the authentication to be checked, and then start this function over again
          this.listenToOnce(
            MetacatUI.appUserModel,
            "change:checked",
            this.handleNotFound,
          );
        }
      },

      /**
       * If the given portal doesn't exist, display a Not Found message.
       */
      showNotFound() {
        const notFoundMessage =
            "The data portal \"&lt;span id='portal-view-not-found-name'>&lt;/span>" +
            "\" doesn't exist.",
          notification = this.alertTemplate({
            classes: "alert-error",
            msg: notFoundMessage,
            includeEmail: true,
          });

        this.$el.html(notification);

        this.$("#portal-view-not-found-name").text(this.label || this.portalId);
      },

      /**
       * Show an error message in this view
       * @param {SolrResult} model
       * @param {XMLHttpRequest.response|string} reponse
       */
      showError(model, response) {
        try {
          const errorMsg = "",
            errorClass = "alert-error",
            icon = "frown",
            portalTerm =
              MetacatUI.appModel.get("portalTermSingular") || "portal",
            errorTitle =
              "Something went wrong displaying this " + portalTerm + ".";

          // For errors resulting from authorization errors, use a friendlier and more
          // helpful error message than the default message returned from fetch
          if (response &amp;&amp; response.status == 401) {
            errorTitle = "You need permission to view this " + portalTerm + ".";
            errorClass = "alert-info";
            icon = "lock";
            // Make a suggestion of how to fix the error based on whether the user is logged in or not.
            if (!MetacatUI.appUserModel.get("loggedIn")) {
              // If not logged in, suggest that the user signs in
              errorMsg =
                '&lt;strong>&lt;a href="' +
                MetacatUI.appModel.get("signInUrlOrcid") +
                window.location.href +
                '">Sign in&lt;/a>&lt;/strong> to see if you have already been given access to view this ' +
                portalTerm +
                ".";
            } else {
              // If signed in, suggest that the user contacts that portal owner
              errorMsg =
                "Contact the owner of this " +
                portalTerm +
                " to request access.";
            }
            // For all other types of errors
          } else {
            if (response &amp;&amp; response.responseText) {
              errorMsg = "Error details: " + $(response.responseText).text();
            }
            if (typeof response == "string") {
              errorMsg = "Error details: " + response;
            }
          }

          if (errorMsg) {
            errorMsg = "&lt;p>" + errorMsg + "&lt;/p>";
          }

          //Show the error message
          MetacatUI.appView.showAlert(
            "&lt;h4>&lt;i class='icon icon-" +
              icon +
              "'>&lt;/i>" +
              errorTitle +
              "&lt;/h4>" +
              errorMsg,
            errorClass + " portal-alert-container",
            this.$el,
            0,
            { includeEmail: true },
          );

          //Remove the loading message from this view
          this.$el.find(".loading").remove();
        } catch (error) {
          console.log(
            "There was a problem trying to display the error message in the Portal View. Error details: " +
              error,
          );
        }
      },

      /**
       * This function is called whenever the window is scrolled.
       */
      handleScroll() {
        const menu = $(".section-links-container")[0],
          menuHeight = $(menu).height(),
          hiddenHeight = menuHeight * -1;
        const currentScrollPos = window.pageYOffset;
        if (MetacatUI.appView.prevScrollpos > currentScrollPos) {
          //Get the height of any menu that may be displayed at the bottom of the page, too

          menu.style.bottom = "0px";
        } else {
          menu.style.bottom = hiddenHeight + "px";
        }
        MetacatUI.appView.prevScrollpos = currentScrollPos;
      },

      /**
       * This function is called when the app navigates away from this view.
       * Any clean-up or housekeeping happens at this time.
       */
      onClose() {
        MetacatUI.appModel.resetTitle();
        MetacatUI.appModel.resetDescription();

        // Run subView onClose functions if they exist
        for (const subView of this.subviews) {
          if (typeof subView?.onClose === "function") {
            subView.onClose();
          }
        }

        //Remove each subview from the DOM and remove listeners
        _.invoke(this.subviews, "remove");

        this.subviews = new Array();

        // Remove any CSS that was added for the theme or layout
        if (this.addedThemeCSS &amp;&amp; this.addedThemeCSS.length) {
          this.addedThemeCSS.forEach(function (cssID) {
            MetacatUI.appModel.removeCSS(cssID);
          });
        }

        //Remove all listeners
        this.stopListening();

        //Reset the active alternate repository
        //MetacatUI.appModel.set("activeAlternateRepositoryId", null);

        //Delete the metrics view from this view
        delete this.sectionMetricsView;
        //Delete the model from this view
        delete this.model;

        //Remove the scroll listener
        $(window).off("scroll", "", this.handleScroll);

        $("body").removeClass("PortalView");

        // Make sure the footer is visible (hidden for dataViz sections + panels layout)
        MetacatUI.footerView.el.style.removeProperty("display");
        document.body.style.removeProperty("--footer-height");

        $("#editPortal").remove();

        this.undelegateEvents();
      },

      /**
       * Checks if the label is a repository
       *
       * @param {string} username - The portal label or the member node repository identifier
       */
      isNode(username) {
        if (username === undefined) {
          this.showNotFound();
          return;
        }
        const model = this;
        const node = _.find(
          MetacatUI.nodeModel.get("members"),
          function (nodeModel) {
            return (
              nodeModel.shortIdentifier.toLowerCase() == username.toLowerCase()
            );
          },
        );

        return node &amp;&amp; node !== undefined;
      },
    },
  );

  return PortalView;
});
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
